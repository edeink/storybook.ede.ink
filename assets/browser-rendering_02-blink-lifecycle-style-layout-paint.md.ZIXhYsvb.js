import{_ as c,C as u,c as p,o as e,j as i,a2 as r,b as o,a as l,w as t,G as s,a3 as d}from"./chunks/framework.C2eRlmqf.js";const B=JSON.parse('{"title":"Blink ç”Ÿå‘½å‘¨æœŸï¼šstyle/layout/paint ä¸æ— æ•ˆåŒ–","description":"","frontmatter":{"title":"Blink ç”Ÿå‘½å‘¨æœŸï¼šstyle/layout/paint ä¸æ— æ•ˆåŒ–","date":"2026-01-20T00:00:00.000Z","categories":"study","tags":["browser-rendering","chromium","blink","style","layout","paint","invalidation"]},"headers":[],"relativePath":"browser-rendering/02-blink-lifecycle-style-layout-paint.md","filePath":"browser-rendering/02-blink-lifecycle-style-layout-paint.md","lastUpdated":1769026429000}'),m={name:"browser-rendering/02-blink-lifecycle-style-layout-paint.md"};function y(_,a,h,b,k,f){const n=u("Mermaid");return e(),p("div",null,[a[2]||(a[2]=i("div",{class:"alert read-stats",role:"note"},[i("span",{class:"read-stats__icon","aria-hidden":"true"},"ğŸ”–"),i("span",{class:"read-stats__text"},[l("æœ¬æ–‡çº¦ "),i("b",null,"1055"),l(" å­—ï¼Œé˜…è¯»é¢„è®¡è€—æ—¶ "),i("b",null,"3"),l(" åˆ†é’Ÿã€‚")])],-1)),a[3]||(a[3]=i("div",{class:"alert ai-disclosure",role:"note"},[i("span",{class:"ai-disclosure__icon","aria-hidden":"true"},"â“˜"),i("span",{class:"ai-disclosure__text"},"AI è¾…åŠ©å†™ä½œå£°æ˜ï¼šæœ¬æ–‡ç”±åšä¸»æ„æ€é€»è¾‘ï¼ŒAI è¾…åŠ©æ¶¦è‰²ï¼ŒåŒæ–¹å…±åŒæ ¡å¯¹ã€‚")],-1)),a[4]||(a[4]=r('<p>è¿™ä¸€ç« è®¨è®ºçš„æ˜¯â€œç½‘é¡µæè¿°ï¼ˆDOM/CSSï¼‰â€å¦‚ä½•åœ¨ Blink é‡Œå˜æˆâ€œå¯ç”»çš„ä¸œè¥¿â€ã€‚å®ƒä¹Ÿæ˜¯å‰ç«¯æ€§èƒ½ä¼˜åŒ–é‡Œæœ€æ ¸å¿ƒçš„ä¸€æ®µï¼šä½ å†™çš„æ¯ä¸€æ¬¡ DOM/CSS æ”¹åŠ¨ï¼Œæœ€ç»ˆéƒ½ä¼šè½åˆ°è¿™é‡Œçš„æŸäº›é˜¶æ®µä¸Šã€‚</p><h2 id="_1-å…ˆæŠŠä¸å˜é‡å†™å‡ºæ¥-blink-åˆ°åº•è¦äº§å‡ºä»€ä¹ˆ" tabindex="-1">1. å…ˆæŠŠä¸å˜é‡å†™å‡ºæ¥ï¼šBlink åˆ°åº•è¦äº§å‡ºä»€ä¹ˆ <a class="header-anchor" href="#_1-å…ˆæŠŠä¸å˜é‡å†™å‡ºæ¥-blink-åˆ°åº•è¦äº§å‡ºä»€ä¹ˆ" aria-label="Permalink to &quot;1. å…ˆæŠŠä¸å˜é‡å†™å‡ºæ¥ï¼šBlink åˆ°åº•è¦äº§å‡ºä»€ä¹ˆ&quot;">â€‹</a></h2><p>æŠŠç»†èŠ‚æŠ½è±¡æ‰ï¼ŒBlink åœ¨ä¸€æ¬¡æ¸²æŸ“æ›´æ–°é‡Œè¦å®Œæˆä¸¤ç±»è¾“å‡ºï¼š</p><ul><li>å‡ ä½•ï¼šæ¯ä¸ªç›’å­åœ¨å“ªé‡Œã€å¤šå¤§ã€æ€ä¹ˆæ»šåŠ¨/è£å‰ª</li><li>ç»˜åˆ¶ï¼šæŠŠå“ªäº›ä¸œè¥¿ç”»å‡ºæ¥ã€æŒ‰ä»€ä¹ˆé¡ºåºç”»ã€å“ªäº›èƒ½å¤ç”¨ç¼“å­˜</li></ul><p>å¯¹åº”åˆ°ç†Ÿæ‚‰çš„è¯ï¼Œå°±æ˜¯ï¼š</p><ul><li>styleï¼šç®—å‡ºè®¡ç®—åçš„æ ·å¼ï¼ˆcomputed styleï¼‰</li><li>layoutï¼šç®—å‡ºå‡ ä½•ï¼ˆlayout result / fragmentsï¼‰</li><li>paintï¼šç”Ÿæˆç»˜åˆ¶ä¸­é—´äº§ç‰©ï¼ˆpaint artifact / display itemsï¼‰</li></ul>',6)),(e(),o(d,null,{default:t(()=>[s(n,{id:"mermaid-43",class:"mermaid",graph:"flowchart%20LR%0A%20%20DOM%5B%22DOM%20%2F%20CSSOM%22%5D%20--%3E%20Style%5B%22Style%20recalc%3Cbr%2F%3Eselector%20match%20%2B%20cascade%22%5D%0A%20%20Style%20--%3E%20Layout%5B%22Layout%3Cbr%2F%3Egeometry%20%2B%20fragments%22%5D%0A%20%20Layout%20--%3E%20Paint%5B%22Paint%3Cbr%2F%3Edisplay%20items%20%2F%20paint%20artifact%22%5D%0A%20%20Paint%20--%3E%20CC%5B%22cc%20commit%3Cbr%2F%3Elayerization%20%2F%20property%20trees%22%5D%0A"})]),fallback:t(()=>[...a[0]||(a[0]=[l(" Loading... ",-1)])]),_:1})),a[5]||(a[5]=r('<h2 id="_2-ä¸ºä»€ä¹ˆ-æ— æ•ˆåŒ–-invalidation-æ¯”ç®—æ³•æ›´é‡è¦" tabindex="-1">2. ä¸ºä»€ä¹ˆâ€œæ— æ•ˆåŒ–ï¼ˆinvalidationï¼‰â€æ¯”ç®—æ³•æ›´é‡è¦ <a class="header-anchor" href="#_2-ä¸ºä»€ä¹ˆ-æ— æ•ˆåŒ–-invalidation-æ¯”ç®—æ³•æ›´é‡è¦" aria-label="Permalink to &quot;2. ä¸ºä»€ä¹ˆâ€œæ— æ•ˆåŒ–ï¼ˆinvalidationï¼‰â€æ¯”ç®—æ³•æ›´é‡è¦&quot;">â€‹</a></h2><p>å‰ç«¯ç»å¸¸æŠŠä¼˜åŒ–ç­‰ä»·æˆâ€œæŠŠ layout ç®—æ³•å˜å¿«â€ã€‚ä½†çœŸå®ä¸–ç•Œé‡Œï¼Œæ›´å¸¸è§çš„å…³é”®æ˜¯ï¼š<strong>ä¸è¦è®©ä¸è¯¥å‚ä¸çš„äººå‚ä¸</strong>ã€‚</p><p>Blink è¦å›ç­”çš„é—®é¢˜ä¸æ˜¯â€œæ€ä¹ˆç®—â€ï¼Œè€Œæ˜¯â€œå“ªäº›éœ€è¦é‡æ–°ç®—â€ï¼š</p><ul><li>style invalidationï¼šå“ªäº›å…ƒç´ çš„ computed style å˜äº†</li><li>layout invalidationï¼šå“ªäº›ç›’å­çš„å‡ ä½•éœ€è¦é‡æ’</li><li>paint invalidationï¼šå“ªäº›åŒºåŸŸéœ€è¦é‡ç»˜</li></ul><p>ä½ å¯ä»¥æŠŠå®ƒç±»æ¯”æˆå¢é‡ç¼–è¯‘ï¼šæ¯æ¬¡ä»£ç æ”¹åŠ¨éƒ½å…¨é‡ç¼–è¯‘å½“ç„¶æ…¢ï¼ŒçœŸæ­£çš„é€Ÿåº¦æ¥è‡ªâ€œæœ€å°å—å½±å“é›†åˆâ€ã€‚</p><h2 id="_3-style-é€‰æ‹©å™¨åŒ¹é…åªæ˜¯å¼€å§‹-çœŸæ­£çš„æˆ˜åœºæ˜¯ç¼“å­˜ä¸ä¾èµ–" tabindex="-1">3. Styleï¼šé€‰æ‹©å™¨åŒ¹é…åªæ˜¯å¼€å§‹ï¼ŒçœŸæ­£çš„æˆ˜åœºæ˜¯ç¼“å­˜ä¸ä¾èµ– <a class="header-anchor" href="#_3-style-é€‰æ‹©å™¨åŒ¹é…åªæ˜¯å¼€å§‹-çœŸæ­£çš„æˆ˜åœºæ˜¯ç¼“å­˜ä¸ä¾èµ–" aria-label="Permalink to &quot;3. Styleï¼šé€‰æ‹©å™¨åŒ¹é…åªæ˜¯å¼€å§‹ï¼ŒçœŸæ­£çš„æˆ˜åœºæ˜¯ç¼“å­˜ä¸ä¾èµ–&quot;">â€‹</a></h2><p>ä»å‰ç«¯è§†è§’çœ‹ï¼Œstyle é˜¶æ®µä¸»è¦æˆæœ¬å¾€å¾€æ¥è‡ªï¼š</p><ul><li>é€‰æ‹©å™¨åŒ¹é…ä¸çº§è”ï¼ˆå°¤å…¶æ˜¯å¤æ‚é€‰æ‹©å™¨ã€æ·±å±‚ DOMï¼‰</li><li>ä¾èµ–ä¼ æ’­ï¼šå­—ä½“ã€åª’ä½“æŸ¥è¯¢ã€å®¹å™¨æŸ¥è¯¢ã€ä¼ªç±»çŠ¶æ€ç­‰</li><li>æ— æ•ˆåŒ–èŒƒå›´ï¼šæŸäº› class åˆ‡æ¢å¯èƒ½å¯¼è‡´å¤§èŒƒå›´é‡æ–°è®¡ç®—</li></ul><p>å·¥ç¨‹ä¸Šå¸¸è§çš„â€œæ„å¤–æ‰©å¤§â€åŒ…æ‹¬ï¼š</p><ul><li>æŠŠæŸä¸ªä¼šé¢‘ç¹å˜åŠ¨çš„ class æŒ‚åœ¨é«˜å±‚å®¹å™¨ä¸Šï¼Œå¯¼è‡´å­æ ‘å¤§é¢ç§¯ style invalidation</li><li>ä½¿ç”¨ä¼šè§¦å‘å…¨æ ‘åŒ¹é…çš„é€‰æ‹©å™¨æ¨¡å¼ï¼ˆä¾‹å¦‚æŸäº›å¤æ‚çš„åä»£é€‰æ‹©å™¨ç»„åˆï¼‰</li></ul><h2 id="_4-layout-è¯»ä¸€ä¸ªå±æ€§-å¯èƒ½å°±æŠŠæ•´æ¡ç®¡çº¿æ‹‰å›æ¥" tabindex="-1">4. Layoutï¼šè¯»ä¸€ä¸ªå±æ€§ï¼Œå¯èƒ½å°±æŠŠæ•´æ¡ç®¡çº¿æ‹‰å›æ¥ <a class="header-anchor" href="#_4-layout-è¯»ä¸€ä¸ªå±æ€§-å¯èƒ½å°±æŠŠæ•´æ¡ç®¡çº¿æ‹‰å›æ¥" aria-label="Permalink to &quot;4. Layoutï¼šè¯»ä¸€ä¸ªå±æ€§ï¼Œå¯èƒ½å°±æŠŠæ•´æ¡ç®¡çº¿æ‹‰å›æ¥&quot;">â€‹</a></h2><p>layout é˜¶æ®µçš„ç¬¬ä¸€æ€§çŸ›ç›¾æ˜¯ï¼šå¾ˆå¤šå‰ç«¯ä»£ç å–œæ¬¢â€œè¯»å®Œå†å†™ï¼Œå†™å®Œå†è¯»â€ã€‚</p><p>å½“ä½ è¯»å–æŸäº›å¸ƒå±€ç›¸å…³ä¿¡æ¯ï¼ˆå…¸å‹ï¼š<code>offsetWidth/getBoundingClientRect</code>ï¼‰ï¼Œæµè§ˆå™¨ä¸ºäº†ä¿è¯è¿”å›å€¼æ­£ç¡®ï¼Œå¯èƒ½ä¼šåœ¨æ­¤åˆ»å¼ºåˆ¶æŠŠ pending çš„ style/layout è®¡ç®—è¡¥é½ã€‚è¿™å°±æ˜¯å¸¸è¯´çš„å¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼ˆlayout flush / layout thrashï¼‰ã€‚</p><p>å…¸å‹å±é™©æ¨¡å¼ï¼š</p><ol><li>è¯»å¸ƒå±€</li><li>å†™ DOMï¼ˆå¯¼è‡´æ— æ•ˆåŒ–ï¼‰</li><li>å†è¯»å¸ƒå±€</li><li>å¾ªç¯å¤šæ¬¡</li></ol>',15)),(e(),o(d,null,{default:t(()=>[s(n,{id:"mermaid-145",class:"mermaid",graph:"sequenceDiagram%0A%20%20participant%20JS%20as%20JS%EF%BC%88main%20thread%EF%BC%89%0A%20%20participant%20Blink%20as%20Blink%20lifecycle%0A%20%20JS-%3E%3EBlink%3A%20write%20DOM%20%2F%20classList%0A%20%20Note%20over%20Blink%3A%20mark%20dirty%EF%BC%88style%2Flayout%EF%BC%89%0A%20%20JS-%3E%3EBlink%3A%20read%20layout%EF%BC%88getBoundingClientRect%EF%BC%89%0A%20%20Blink--%3E%3EJS%3A%20force%20flush%EF%BC%88style%2Blayout%EF%BC%89%0A%20%20JS-%3E%3EBlink%3A%20write%20DOM%20again%0A%20%20JS-%3E%3EBlink%3A%20read%20layout%20again%0A%20%20Blink--%3E%3EJS%3A%20force%20flush%20again%EF%BC%88%E6%8A%96%E5%8A%A8%EF%BC%89%0A"})]),fallback:t(()=>[...a[1]||(a[1]=[l(" Loading... ",-1)])]),_:1})),a[6]||(a[6]=r('<p>å¦‚æœä½ åªè®°ä½ä¸€ä¸ªæŠ€å·§ï¼šæŠŠè¯»å¸ƒå±€ä¸å†™å¸ƒå±€åˆ†æˆæ‰¹æ¬¡ï¼Œå°½é‡ä¸è¦äº¤é”™ã€‚</p><h2 id="_5-paint-ä½ ä»¥ä¸ºæ˜¯-ç”»ä¸€ä¸‹-å…¶å®æ˜¯ç”Ÿæˆå¯å¤ç”¨çš„ä¸­é—´äº§ç‰©" tabindex="-1">5. Paintï¼šä½ ä»¥ä¸ºæ˜¯â€œç”»ä¸€ä¸‹â€ï¼Œå…¶å®æ˜¯ç”Ÿæˆå¯å¤ç”¨çš„ä¸­é—´äº§ç‰© <a class="header-anchor" href="#_5-paint-ä½ ä»¥ä¸ºæ˜¯-ç”»ä¸€ä¸‹-å…¶å®æ˜¯ç”Ÿæˆå¯å¤ç”¨çš„ä¸­é—´äº§ç‰©" aria-label="Permalink to &quot;5. Paintï¼šä½ ä»¥ä¸ºæ˜¯â€œç”»ä¸€ä¸‹â€ï¼Œå…¶å®æ˜¯ç”Ÿæˆå¯å¤ç”¨çš„ä¸­é—´äº§ç‰©&quot;">â€‹</a></h2><p>paint é˜¶æ®µå¹¶ä¸æ˜¯ç›´æ¥æŠŠåƒç´ ç”»åˆ°å±å¹•ä¸Šï¼Œå®ƒæ›´åƒæ˜¯ï¼š</p><ul><li>ç”Ÿæˆç»˜åˆ¶åˆ—è¡¨ï¼ˆdisplay itemsï¼‰</li><li>æ„å»ºå¯ç¼“å­˜çš„ç»˜åˆ¶ä¸­é—´äº§ç‰©ï¼ˆpaint artifactï¼‰</li><li>è®°å½•æ— æ•ˆåŒºåŸŸï¼ˆinvalidationsï¼‰ä¾›åç»­æ …æ ¼åŒ–å¤ç”¨</li></ul><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸€äº›â€œçœ‹èµ·æ¥æ²¡åŠ¨â€çš„ CSSï¼Œå¯èƒ½ä¼šè®© paint æˆæœ¬æš´å¢ï¼š</p><ul><li>é˜´å½±ã€æ»¤é•œã€åŠé€æ˜å åŠ </li><li>å¤æ‚è·¯å¾„ã€é¢‘ç¹å˜åŒ–çš„ clip</li><li>å¤§é¢ç§¯é‡ç»˜ï¼ˆå°¤å…¶é«˜åˆ†å±ä¸‹åƒç´ æ•°çˆ†ç‚¸ï¼‰</li></ul><h2 id="_6-ä»-blink-åˆ°-cc-ä»€ä¹ˆæ—¶å€™ä¼š-å‡å±‚" tabindex="-1">6. ä» Blink åˆ° ccï¼šä»€ä¹ˆæ—¶å€™ä¼šâ€œå‡å±‚â€ <a class="header-anchor" href="#_6-ä»-blink-åˆ°-cc-ä»€ä¹ˆæ—¶å€™ä¼š-å‡å±‚" aria-label="Permalink to &quot;6. ä» Blink åˆ° ccï¼šä»€ä¹ˆæ—¶å€™ä¼šâ€œå‡å±‚â€&quot;">â€‹</a></h2><p>ä»ä¸»çº¿ç¨‹äº§å‡ºçš„ paint ç»“æœï¼Œä¼šåœ¨åç»­é˜¶æ®µè¢«ç”¨äºåˆæˆï¼ˆcompositingï¼‰ã€‚</p><p>å‰ç«¯å¸¸è§çš„è¯¯åŒºæ˜¯æŠŠâ€œlayerâ€å½“æˆå…è´¹åˆé¤ï¼šå‡å±‚å¯èƒ½è®©æŸäº›åŠ¨ç”»èµ°åˆæˆçº¿ç¨‹æ›´é¡ºï¼Œä½†ä¹Ÿå¯èƒ½å¸¦æ¥ï¼š</p><ul><li>æ›´å¤šçº¹ç†ï¼ˆæ˜¾å­˜å ç”¨ï¼‰</li><li>æ›´å¤šæ …æ ¼åŒ–ç“¦ç‰‡ï¼ˆraster å‹åŠ›ï¼‰</li><li>æ›´å¤æ‚çš„åˆæˆæ ‘ï¼ˆcommit/activate åŒæ­¥ç‚¹å‹åŠ›ï¼‰</li></ul><p>æ‰€ä»¥æ›´é è°±çš„å£å¾„æ˜¯ï¼šæŠŠå‡å±‚å½“ä½œä¸€ç§â€œæŠŠæˆæœ¬ä» main thread æŒªåˆ° raster/gpu çš„é€‰æ‹©â€ï¼Œå¹¶ä¸ç­‰äºæˆæœ¬æ¶ˆå¤±ã€‚</p><h2 id="_7-è¿™ä¸€ç« çš„æ’éšœæ¸…å•-åå·¥ç¨‹" tabindex="-1">7. è¿™ä¸€ç« çš„æ’éšœæ¸…å•ï¼ˆåå·¥ç¨‹ï¼‰ <a class="header-anchor" href="#_7-è¿™ä¸€ç« çš„æ’éšœæ¸…å•-åå·¥ç¨‹" aria-label="Permalink to &quot;7. è¿™ä¸€ç« çš„æ’éšœæ¸…å•ï¼ˆåå·¥ç¨‹ï¼‰&quot;">â€‹</a></h2><ul><li>style å¾ˆè´µï¼šå…ˆæ€€ç–‘ invalidation èŒƒå›´æ˜¯ä¸æ˜¯å¤ªå¤§</li><li>layout å¾ˆè´µï¼šå…ˆæ’æŸ¥æœ‰æ²¡æœ‰ forced reflowï¼ˆè¯»å†™äº¤é”™ï¼‰</li><li>paint å¾ˆè´µï¼šå…ˆçœ‹æ˜¯å¦å¤§é¢ç§¯é‡ç»˜ã€æ˜¯å¦æœ‰æ˜‚è´µçš„è§†è§‰æ•ˆæœ</li><li>ç»“è®ºè¦è½åˆ°â€œå“ªä¸ªé˜¶æ®µå˜è´µã€ä¸ºä»€ä¹ˆå˜è´µâ€ï¼Œè€Œä¸æ˜¯ä¸€å¥â€œé¡µé¢å¾ˆå¡â€</li></ul><h2 id="å‚è€ƒ" tabindex="-1">å‚è€ƒ <a class="header-anchor" href="#å‚è€ƒ" aria-label="Permalink to &quot;å‚è€ƒ&quot;">â€‹</a></h2><ul><li>Chromium docsï¼ˆBlink ç›¸å…³å…¥å£ï¼‰<a href="https://chromium.googlesource.com/chromium/src/+/main/docs/" target="_blank" rel="noreferrer">https://chromium.googlesource.com/chromium/src/+/main/docs/</a></li><li>A Pixelï¼ˆæ¸²æŸ“ä¸»çº¿è§†è§’ï¼‰<a href="https://docs.google.com/presentation/d/1boPxbgNrTU0ddsc144rcXayGA_WF53k96imRH8Mp34Y/edit" target="_blank" rel="noreferrer">https://docs.google.com/presentation/d/1boPxbgNrTU0ddsc144rcXayGA_WF53k96imRH8Mp34Y/edit</a></li><li>Web Browser Engineeringï¼ˆç”¨å¯è·‘çš„å®ç°ç†è§£ç®¡çº¿ï¼‰<a href="https://browser.engineering/" target="_blank" rel="noreferrer">https://browser.engineering/</a></li></ul>',15))])}const A=c(m,[["render",y]]);export{B as __pageData,A as default};
