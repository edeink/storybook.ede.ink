<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面” | 2026</title>
    <meta name="description" content="Book preview from source/_posts/2026">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.UOQkJNym.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BegvNVcs.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.BAs4fWuZ.js">
    <link rel="modulepreload" href="/assets/chunks/theme.CjZuZrxq.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/web-editor_09-layout-algorithms-constraint.md.CiKt2lJB.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor-->
    <div id="app"><div class="Layout" data-v-7e31dfad><!--[--><!--]--><!--[--><span tabindex="-1" data-v-39971c1e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-39971c1e>Skip to content</a><!--]--><!----><header class="VPNav" data-v-7e31dfad data-v-777e29d8><div class="VPNavBar" data-v-777e29d8 data-v-28354aa7><div class="wrapper" data-v-28354aa7><div class="container" data-v-28354aa7><div class="title" data-v-28354aa7><div class="VPNavBarTitle has-sidebar" data-v-28354aa7 data-v-7aef3d92><a class="title" href="/" data-v-7aef3d92><!--[--><!--]--><!----><span data-v-7aef3d92>2026</span><!--[--><!--]--></a></div></div><div class="content" data-v-28354aa7><div class="content-body" data-v-28354aa7><!--[--><!--]--><div class="VPNavBarSearch search" data-v-28354aa7><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-28354aa7 data-v-ac871bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ac871bc4 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-28354aa7 data-v-554c9a17 data-v-195e553c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-195e553c><span class="vpi-more-horizontal icon" data-v-195e553c></span></button><div class="menu" data-v-195e553c><div class="VPMenu" data-v-195e553c data-v-d91ff435><!----><!--[--><!--[--><!----><div class="group" data-v-554c9a17><div class="item appearance" data-v-554c9a17><p class="label" data-v-554c9a17>Appearance</p><div class="appearance-action" data-v-554c9a17><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-554c9a17 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-28354aa7 data-v-c95a1bd1><span class="container" data-v-c95a1bd1><span class="top" data-v-c95a1bd1></span><span class="middle" data-v-c95a1bd1></span><span class="bottom" data-v-c95a1bd1></span></span></button></div></div></div></div><div class="divider" data-v-28354aa7><div class="divider-line" data-v-28354aa7></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-7e31dfad data-v-d1d97dc0><div class="container" data-v-d1d97dc0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d1d97dc0><span class="vpi-align-left menu-icon" data-v-d1d97dc0></span><span class="menu-text" data-v-d1d97dc0>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-d1d97dc0 data-v-4833277d><button data-v-4833277d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-7e31dfad data-v-3fd06dd3><div class="curtain" data-v-3fd06dd3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fd06dd3><span class="visually-hidden" id="sidebar-aria-label" data-v-3fd06dd3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-efbd6156><section class="VPSidebarItem level-0 collapsible has-active" data-v-efbd6156 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h2 class="text" data-v-46688d19>目录</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/" data-v-46688d19><!--[--><p class="text" data-v-46688d19>引序</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed has-active" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>Web 编辑器与协同</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/01-editor-architecture" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器：核心架构与“轮点”演进</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/02-collaboration-crdt-ot" data-v-46688d19><!--[--><p class="text" data-v-46688d19>协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/03-plugin-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器插件体系：可扩展、可治理、可兜底</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/04-doc-storage-and-indexes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/05-versioning-and-incremental-sync" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/06-open-source-editors-comparison" data-v-46688d19><!--[--><p class="text" data-v-46688d19>开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/07-fonts-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>字体发展史与字体的秘密：从 OpenType 到编辑器排版管线</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/08-images-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/09-layout-algorithms-constraint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/10-unicode-linebreak-bidi-grapheme" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/11-hit-testing-and-event-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>点击测试（Hit Testing）与事件系统：从坐标到交互闭环</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/12-rendering-graphics-details" data-v-46688d19><!--[--><p class="text" data-v-46688d19>渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>浏览器底层与图形渲染</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/01-chromium-architecture-processes-and-threads" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Chromium 架构总览：多进程与线程模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/02-blink-lifecycle-style-layout-paint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Blink 生命周期：style/layout/paint 与无效化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/03-cc-compositor-commit-activate-draw" data-v-46688d19><!--[--><p class="text" data-v-46688d19>cc 合成体系：两棵树、属性树与同步点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/04-viz-gpu-and-present-to-screen" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Viz/GPU/上屏：surface、buffer 与显示路径</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/05-input-latency-scroll-and-hit-test" data-v-46688d19><!--[--><p class="text" data-v-46688d19>输入与滚动：事件路由、命中与延迟下限</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc" data-v-46688d19><!--[--><p class="text" data-v-46688d19>V8 细节（前端视角）：优化、deopt 与 GC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Worker：收益边界、OffscreenCanvas 与通信成本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/08-performance-tracing-devtools-perfetto" data-v-46688d19><!--[--><p class="text" data-v-46688d19>可观测：DevTools、Tracing/Perfetto 与归因方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/09-frontend-levers-css-composite-paint-budget" data-v-46688d19><!--[--><p class="text" data-v-46688d19>前端对照表：哪些写法对应哪条渲染管线</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>AI 碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/01-ai-core-intuition" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 核心直觉：从梯度下降到 Transformer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/02-diffusion-principle" data-v-46688d19><!--[--><p class="text" data-v-46688d19>图像生成原理：扩散模型与 Latent Space</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/03-ecommerce-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>电商实战：AIGC 图文生产与 Agent 落地</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/04-engineering-paradigm" data-v-46688d19><!--[--><p class="text" data-v-46688d19>工程范式：Vibe Coding 与 AI 时代的研发心法</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>工作的碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-aigc-interview-notes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2015-2025：十年技术路（面试速记版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-core-plus-plugins" data-v-46688d19><!--[--><p class="text" data-v-46688d19>为什么重交互产品都长成 Core + Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-release-patterns" data-v-46688d19><!--[--><p class="text" data-v-46688d19>四种发版节奏对比</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2025：十年再回首我的工作经历</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-7e31dfad data-v-cfc5462b><div class="VPDoc has-sidebar has-aside" data-v-cfc5462b data-v-55d9feae><!--[--><!--]--><div class="container" data-v-55d9feae><div class="aside" data-v-55d9feae><div class="aside-curtain" data-v-55d9feae></div><div class="aside-container" data-v-55d9feae><div class="aside-content" data-v-55d9feae><div class="VPDocAside" data-v-55d9feae data-v-af649e6a><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-af649e6a data-v-bc4063f9><div class="content" data-v-bc4063f9><div class="outline-marker" data-v-bc4063f9></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-bc4063f9>On this page</div><ul class="VPDocOutlineItem root" data-v-bc4063f9 data-v-9f82df79><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-af649e6a></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-55d9feae><div class="content-container" data-v-55d9feae><!--[--><!--]--><main class="main" data-v-55d9feae><div style="position:relative;" class="vp-doc _web-editor_09-layout-algorithms-constraint" data-v-55d9feae><div><div class="alert read-stats" role="note"><span class="read-stats__icon" aria-hidden="true">🔖</span><span class="read-stats__text">本文约 <b>3919</b> 字，阅读预计耗时 <b>10</b> 分钟。</span></div><div class="alert ai-disclosure" role="note"><span class="ai-disclosure__icon" aria-hidden="true">ⓘ</span><span class="ai-disclosure__text">AI 辅助写作声明：本文由博主构思逻辑，AI 辅助润色，双方共同校对。</span></div><p>排版是编辑器里最“温柔的暴力”：你把一棵树交给它，它要在有限宽度里塞下文字、图片、表格、公式，还要保证光标能走、选区能画、点击能命中。</p><h2 id="问题-什么是-排版算法-编辑器为什么不能只靠-css" tabindex="-1">问题：什么是“排版算法”，编辑器为什么不能只靠 CSS？ <a class="header-anchor" href="#问题-什么是-排版算法-编辑器为什么不能只靠-css" aria-label="Permalink to &quot;问题：什么是“排版算法”，编辑器为什么不能只靠 CSS？&quot;">​</a></h2><p>如果你只是展示内容，CSS 就够了。</p><p>但编辑器要做交互，它需要额外的信息：</p><ul><li>每个字符/节点的几何边界（bounds）</li><li>每一行的断行点（line break positions）</li><li>光标的精确位置（caret x/y）</li><li>选区的 rect 列表（range rects）</li></ul><p>CSS 帮你渲染，但它不保证你能拿到稳定、可控、可回放的中间结果。特别是当你做：</p><ul><li>自定义渲染（Canvas/WebGL）</li><li>大文档增量排版（只排受影响的段落）</li><li>特殊排版规则（表格、公式、约束布局）</li></ul><p>你最终会写自己的 layout layer（哪怕只是一部分）。</p><h2 id="分析-排版的两层抽象-纵向深入" tabindex="-1">分析：排版的两层抽象（纵向深入） <a class="header-anchor" href="#分析-排版的两层抽象-纵向深入" aria-label="Permalink to &quot;分析：排版的两层抽象（纵向深入）&quot;">​</a></h2><p>我用两层来理解：</p><ol><li>版面层（Geometry Layer）：把文档节点映射成盒子（boxes）与行（lines）</li><li>求解层（Solver Layer）：当有约束（constraints）时，如何求出盒子的位置与尺寸</li></ol><h3 id="约束布局示意图-源文件-assets-diagrams-layout-constraint-solver-mmd" tabindex="-1">约束布局示意图（源文件：<code>../assets/diagrams/layout-constraint-solver.mmd</code>） <a class="header-anchor" href="#约束布局示意图-源文件-assets-diagrams-layout-constraint-solver-mmd" aria-label="Permalink to &quot;约束布局示意图（源文件：`../assets/diagrams/layout-constraint-solver.mmd`）&quot;">​</a></h3><!--[--><div class="vp-code-group" data-v-41b06022><pre data-v-41b06022><code data-v-41b06022>flowchart LR
  D[Document Tree] --&gt; B[Box Model&lt;br/&gt;(block/inline/replaced)]
  B --&gt; C[Constraints&lt;br/&gt;(equal/&lt;=/&gt;=)]
  C --&gt; S[Solver&lt;br/&gt;(incremental)]
  S --&gt; G[Geometry&lt;br/&gt;(x,y,w,h)]
  G --&gt; H[Hit Test / Selection / Render]
</code></pre></div><!--teleport start--><!--teleport end--><!--]--><h2 id="横向比较-常见排版算法与适用场景" tabindex="-1">横向比较：常见排版算法与适用场景 <a class="header-anchor" href="#横向比较-常见排版算法与适用场景" aria-label="Permalink to &quot;横向比较：常见排版算法与适用场景&quot;">​</a></h2><table tabindex="0"><thead><tr><th>算法/系统</th><th>核心思想</th><th>优势</th><th>劣势</th><th>编辑器用途</th></tr></thead><tbody><tr><td>Greedy line breaking</td><td>能放就放，不行就换行</td><td>快、好实现</td><td>视觉效果可能差</td><td>普通段落、实时输入</td></tr><tr><td>Knuth–Plass</td><td>全局最优断行（惩罚函数）</td><td>排版质量高</td><td>实现复杂、成本高</td><td>导出/打印/PDF</td></tr><tr><td>Flexbox</td><td>一维弹性分配</td><td>响应式强</td><td>与文本断行结合复杂</td><td>工具栏、容器布局</td></tr><tr><td>Grid</td><td>二维网格</td><td>结构稳定</td><td>约束多时复杂</td><td>表格/排版模板</td></tr><tr><td>Constraint-based layout</td><td>把关系写成约束方程</td><td>表达力强、可组合</td><td>需要 solver、调试困难</td><td>表格/图文混排/对齐系统</td></tr></tbody></table><p>四舍五入：编辑器常用组合是“输入时 greedy + 导出时更高质量算法”，把成本花在对的地方。</p><h2 id="解决方案-一个可增量的排版框架" tabindex="-1">解决方案：一个可增量的排版框架 <a class="header-anchor" href="#解决方案-一个可增量的排版框架" aria-label="Permalink to &quot;解决方案：一个可增量的排版框架&quot;">​</a></h2><p>编辑器的关键不是“排一次”，而是“每次输入只排一小块”。</p><p>通常会有三个缓存层：</p><ul><li>文档层缓存：段落的 token/glyph runs</li><li>行缓存：断行结果与每行宽度</li><li>几何缓存：每个 run 的 bounds（给 hit test/selection 用）</li></ul><h3 id="版面层-box-line-rect-的-最小集合" tabindex="-1">版面层：Box/Line/Rect 的“最小集合” <a class="header-anchor" href="#版面层-box-line-rect-的-最小集合" aria-label="Permalink to &quot;版面层：Box/Line/Rect 的“最小集合”&quot;">​</a></h3><p>你可以把版面层当成一个几何账本（Geometry Ledger）：它不关心 DOM，也不关心语义，只关心“哪里有东西”。</p><p>一个足够实用的最小集合通常是：</p><ul><li>Rect(x, y, w, h)：所有几何都落到矩形（便于 hit testing/selection）</li><li>BlockBox：垂直堆叠的块级盒子（段落、列表项、表格行）</li><li>InlineRun：一段连续的 inline 内容（文本 glyph run、inline 节点）</li><li>ReplacedBox：可替换内容（图片、公式、嵌入卡片）</li></ul><p>比喻：排版像停车。BlockBox 是停车场的“车道”，InlineRun 是“车位线”，ReplacedBox 是“开 SUV 的那位同学”，你得给他留足位置，不然会顶到别人。</p><h3 id="greedy-断行-实时输入阶段最常用的-能跑就行" tabindex="-1">Greedy 断行：实时输入阶段最常用的“能跑就行” <a class="header-anchor" href="#greedy-断行-实时输入阶段最常用的-能跑就行" aria-label="Permalink to &quot;Greedy 断行：实时输入阶段最常用的“能跑就行”&quot;">​</a></h3><p>Greedy 断行的规则很朴素：</p><ol><li>从左到右累加内容宽度</li><li>一旦超过 maxWidth，就在上一个可断点处断行</li><li>继续处理下一行</li></ol><p>它之所以适合编辑器“实时输入”，原因很现实：</p><ul><li>成本可控：你可以把它限制在“当前段落/当前行附近”</li><li>易增量：输入一个字符，只影响当前行或相邻行</li></ul><p>边界条件也要写死：</p><ul><li>超长不可断词：硬断/缩放/溢出显示，必须选一个兜底</li><li>空白折叠规则：连续空格、tab、换行在不同语义下处理不同</li></ul><h3 id="knuth–plass-用-惩罚函数-动态规划-换排版质量" tabindex="-1">Knuth–Plass：用“惩罚函数 + 动态规划”换排版质量 <a class="header-anchor" href="#knuth–plass-用-惩罚函数-动态规划-换排版质量" aria-label="Permalink to &quot;Knuth–Plass：用“惩罚函数 + 动态规划”换排版质量&quot;">​</a></h3><p><a href="https://picture.iczhiku.com/weixin/message1569293870840.html" target="_blank" rel="noreferrer">Knuth–Plass</a> 的核心不是“动态规划很酷”，而是它把“排版好看”翻译成一个可计算目标。</p><p>设一行的剩余空间（slack）为：</p><ul><li>slack(i, j) = maxWidth - width(words[i..j])</li></ul><p>当 slack &lt; 0，说明放不下，是非法断行；当 slack ≥ 0，可以定义一个惩罚（badness），例如：</p><ul><li>badness(i, j) = slack(i, j)²（或更常见的 slack³，强调过松的惩罚）</li></ul><p>动态规划的递推式就很自然：</p><ul><li dp[i]="" +="" badness(i,="" j)="">dp[j] = min over i&lt;j</li></ul><p>这套方法适合“导出/打印/PDF”，因为它倾向于全局最优，而不是局部凑合。编辑器里也能用，但通常会限定窗口（只在段落内、或只在某一段长度上做 DP），否则成本会变得不可控。</p><!--[--><div class="vp-code-group" data-v-41b06022><pre data-v-41b06022><code data-v-41b06022>flowchart TB
  W[输入: words] --&gt; M[测量宽度 width()]
  M --&gt; C[枚举断行候选 (i,j)]
  C --&gt; B[计算 slack/badness]
  B --&gt; DP[动态规划求最小代价 dp]
  DP --&gt; R[回溯断点序列]
  R --&gt; L[输出: line breaks]
</code></pre></div><!--teleport start--><!--teleport end--><!--]--><h3 id="约束布局-当-关系-比-尺寸-更重要" tabindex="-1">约束布局：当“关系”比“尺寸”更重要 <a class="header-anchor" href="#约束布局-当-关系-比-尺寸-更重要" aria-label="Permalink to &quot;约束布局：当“关系”比“尺寸”更重要&quot;">​</a></h3><p>当你在做表格对齐、图文混排、对齐线、组件卡片等场景时，布局更像在解方程：</p><ul><li>x_B = x_A + w_A + gap（B 在 A 右边，留 gap）</li><li>w_A + w_B = containerWidth（两列平分）</li><li>baseline(text) 与 baseline(image) 对齐（混排对齐）</li></ul><p>约束系统的工程意义是：你把“关系”写出来，求解器负责找到一组满足关系的几何解。</p><p>编辑器更偏好“可增量求解”：</p><ul><li>输入只改动局部约束与局部变量</li><li>求解只触达受影响的子图（而不是全局重排）</li></ul><p>这也是为什么很多系统会选择增量约束求解（概念上接近 Cassowary 一类思想）：不是因为它最优雅，而是因为它更像工程系统能承受的形态。</p><p>上面这些听起来玄学，但你一旦把“关系”写成约束，就会发现调试也能变得可解释：哪条约束冲突了、哪条被降级为软约束了、哪条优先级更高了，都会有迹可循。</p><h2 id="增量排版-编辑器真正吃饭的家伙" tabindex="-1">增量排版：编辑器真正吃饭的家伙 <a class="header-anchor" href="#增量排版-编辑器真正吃饭的家伙" aria-label="Permalink to &quot;增量排版：编辑器真正吃饭的家伙&quot;">​</a></h2><p>编辑器和排版引擎最大的差异是：编辑器不是“排一次”，而是“边排边改”。输入一个字符，你如果全局重排，长文档必死。</p><p>增量排版一般会围绕一个概念：dirty range（脏区间）。</p><ul><li>输入发生在某个段落/某个 block 内</li><li>这个 block 的断行、几何、以及后续 block 的 y 坐标可能变化</li><li>但绝大多数 block 的内容与断行并没有变</li></ul><p>工程上通常会把增量拆成两段：</p><ol><li>局部重排：只重排受影响的段落（重新 shaping/断行，得到新行盒）</li><li>位置平移：对后续段落做 y 偏移（把“坐标变化”从“结构变化”里拆出来）</li></ol><p>你可以把它类比成“队伍挪位”：</p><ul><li>某个人换了更大的背包（段落变长，行数增加）</li><li>这会影响他后面的所有人站位（y 偏移）</li><li>但后面每个人的长相没变（glyph run 不变），你不需要重新画他们的脸</li></ul><p>当然这个类比也暴露了边界条件：如果你在队伍中间插入一张大桌子（图片/表格），后面人的站位会大幅变化，增量的影响面会变大，但依然不需要全局重排。</p><h2 id="让排版可交互-caret-与-selection-需要-行内数据结构" tabindex="-1">让排版可交互：caret 与 selection 需要“行内数据结构” <a class="header-anchor" href="#让排版可交互-caret-与-selection-需要-行内数据结构" aria-label="Permalink to &quot;让排版可交互：caret 与 selection 需要“行内数据结构”&quot;">​</a></h2><p>很多排版方案只输出“行文本”，但编辑器需要更多：</p><ul><li>每行的 glyph advances（用于从 x 找 offset）</li><li>每个 run 的 bounds（用于选区 rect）</li><li>baseline（用于 inline 对齐与光标绘制）</li></ul><p>因此排版结果最好是一个“可查询的数据结构”，而不仅是一个渲染命令序列。</p><p>四舍五入：排版的输出如果不能支持 hit testing，你就得在渲染层再做一遍几何计算，最后又慢又不一致。</p><h2 id="工程实践-性能优化与异常处理" tabindex="-1">工程实践：性能优化与异常处理 <a class="header-anchor" href="#工程实践-性能优化与异常处理" aria-label="Permalink to &quot;工程实践：性能优化与异常处理&quot;">​</a></h2><h3 id="性能" tabindex="-1">性能 <a class="header-anchor" href="#性能" aria-label="Permalink to &quot;性能&quot;">​</a></h3><ul><li>增量排版：输入导致的变更通常只影响当前段落或相邻段落</li><li>缓存：glyph run、断行结果、bounds 全都应该有 cache key</li><li>分帧：超预算排版分帧执行，保证输入不掉帧</li></ul><h3 id="异常" tabindex="-1">异常 <a class="header-anchor" href="#异常" aria-label="Permalink to &quot;异常&quot;">​</a></h3><ul><li>超长不可断词：必须有兜底策略（硬断/缩放/溢出）</li><li>不可测量字体：fallback 或延迟排版（font loading）</li><li>混排节点：图片/公式/表格的 baseline 与 lineHeight 需要统一约定</li></ul><h2 id="稳定性-排版不是-算出来就行-而是-不要抖" tabindex="-1">稳定性：排版不是“算出来就行”，而是“不要抖” <a class="header-anchor" href="#稳定性-排版不是-算出来就行-而是-不要抖" aria-label="Permalink to &quot;稳定性：排版不是“算出来就行”，而是“不要抖”&quot;">​</a></h2><p>编辑器排版还有一个经常被忽略的目标：稳定。用户打字时，如果每输入一个字符整段文字就像水波一样来回抖动，体验会非常差。稳定性通常来自两件事：</p><ul><li><strong>同样输入得到同样断行</strong>：断行算法要尽量减少“临界点抖动”，否则光标位置与滚动锚点都会跳</li><li><strong>增量范围尽量小</strong>：能只重排一个段落，就不要牵连后续整个页面</li></ul><p>你可以把它抽象成一个更像“工程指标”的东西：一次输入导致的视觉变化范围 Δ。理想情况下，Δ 主要发生在当前段落内部；如果 Δ 经常扩散到后续很多屏幕，那就说明你的增量策略或缓存策略出了问题。</p><h2 id="约束排版的现实落地-软约束优先-硬约束兜底" tabindex="-1">约束排版的现实落地：软约束优先，硬约束兜底 <a class="header-anchor" href="#约束排版的现实落地-软约束优先-硬约束兜底" aria-label="Permalink to &quot;约束排版的现实落地：软约束优先，硬约束兜底&quot;">​</a></h2><p>很多“约束排版”介绍会把问题讲成求解线性方程组，但编辑器里更常见的是“软约束主导”的思路：你不追求一次求到最优解，而追求可解释、可增量、可止血。</p><ul><li>软约束：尽量满足（例如段落两端对齐、行宽接近目标、行间距一致）</li><li>硬约束：必须满足（例如不能越界、不能负宽度、不可断词时必须有兜底）</li></ul><p>用一个直觉化的表达：你在最小化一个代价函数 Cost = Σ wᵢ · penaltyᵢ。软约束对应 penalty，权重 w 决定了“宁愿牺牲什么”。这件事很重要，因为它能把“排版风格”从代码里提炼成参数：产品要更紧凑还是更松弛，本质上就是权重的选择。</p><h2 id="滚动锚点-排版系统的隐藏需求是-别把用户带走" tabindex="-1">滚动锚点：排版系统的隐藏需求是“别把用户带走” <a class="header-anchor" href="#滚动锚点-排版系统的隐藏需求是-别把用户带走" aria-label="Permalink to &quot;滚动锚点：排版系统的隐藏需求是“别把用户带走”&quot;">​</a></h2><p>编辑器排版还有一个常见但隐蔽的需求：滚动锚点（scroll anchoring）。用户在长文档中间输入时，他的视口不应该突然跳到别处；哪怕段落增删导致后续内容整体下移，用户也希望“我正在看的那一行还在原地”。</p><p>这件事在 DOM 编辑器里部分由浏览器兜底，但在自研排版里你必须自己定义规则。一个更稳的思路是把锚点当成一条约束：</p><ul><li>选择一个锚点元素（通常是当前 caret 所在行或段落）</li><li>记录它在输入前的屏幕坐标 y₀</li><li>增量排版后，计算它的新坐标 y₁</li><li>通过滚动偏移补偿 Δy = y₁ - y₀，让锚点视觉位置保持不变</li></ul><p>它看起来像简单的减法，但它会把排版、命中、选择映射三条链路绑在一起：如果你的几何缓存不稳定，锚点就会抖；如果你的增量范围过大，补偿就会变成跳屏。</p><h2 id="分页与分栏-一旦你要-像文档一样-排版复杂度会再上一个台阶" tabindex="-1">分页与分栏：一旦你要“像文档一样”，排版复杂度会再上一个台阶 <a class="header-anchor" href="#分页与分栏-一旦你要-像文档一样-排版复杂度会再上一个台阶" aria-label="Permalink to &quot;分页与分栏：一旦你要“像文档一样”，排版复杂度会再上一个台阶&quot;">​</a></h2><p>很多编辑器早期只做“连续滚动”的单栏排版，但当你需要：</p><ul><li>打印与 PDF 导出</li><li>多栏排版（杂志/简历/报告）</li><li>固定页高的分页视图</li></ul><p>你会发现布局系统的单位不再只是“行与段落”，还要引入“页与栏”的约束：行盒不仅要算 x/y，还要受页面边距、分页点、孤行寡行规则等限制。</p><p>更工程化的落地方式通常是先把分页当成“切分规则”，而不是当成一次性全局重排：先完成单栏的稳定增量排版，再在其上叠加分页/分栏的切分与偏移。这样你能复用已有的行盒数据结构，并把新增复杂度限制在“切分与映射”这一层，而不是重写整套排版引擎。</p><h2 id="富文本行高-lineheight-不是一个数-而是一套约定" tabindex="-1">富文本行高：lineHeight 不是一个数，而是一套约定 <a class="header-anchor" href="#富文本行高-lineheight-不是一个数-而是一套约定" aria-label="Permalink to &quot;富文本行高：lineHeight 不是一个数，而是一套约定&quot;">​</a></h2><p>排版系统里还有一个特别容易被忽略、但会直接影响命中与选区的细节：行高。你以为 lineHeight 只是一个数字，但编辑器里它往往是一套约定的结果：</p><ul><li>inline 混排：同一行里既有文字，又有图片、公式、标签胶囊</li><li>baseline 对齐：不同字体、不同字号、不同脚本的基线不一样</li><li>行距策略：是跟随最大 ascent/descent，还是固定行距并做垂直居中</li></ul><p>这会把“画出来”和“交互正确”绑在一起：如果你的行高规则不稳定，selection rect 可能画错，hit testing 也可能返回错误的行。更稳的策略是把行盒作为一等公民：每行明确记录 baseline、ascent、descent 与最终行高，并保证这套数据既用于渲染，也用于命中与选择。</p><p>补一个常见但容易忽略的工程后果：当行盒数据结构稳定后，你才能把“脏区间”真正做到可控。因为 dirty 的传播单位不该是字符，也不该是整个文档，而应该是行/段/块这类能被缓存的排版单元。否则你会陷入一种反复重排的循环：你以为只改了一点点，但系统不知道“影响面”到底多大，只能保守地重算更多内容，最后性能与稳定性都被拖垮。</p><p>最后提醒一句：排版系统的“正确”不是数学意义的完美，而是工程意义的可控。你能解释它为什么这么断行、为什么这么对齐、为什么这次只重排了这几行，并且在最坏情况下也能保证不掉帧、不跳屏，这才是编辑器排版真正的底线。</p><p>当你能做到这一点，排版才算真正上线。</p><h2 id="补充-文本布局其实是一套-松散层级-的分段与组装" tabindex="-1">补充：文本布局其实是一套“松散层级”的分段与组装 <a class="header-anchor" href="#补充-文本布局其实是一套-松散层级-的分段与组装" aria-label="Permalink to &quot;补充：文本布局其实是一套“松散层级”的分段与组装&quot;">​</a></h2><p>很多排版系统的讲法喜欢把流程画成直线：Style → Layout → Shaping → Raster → Composite。这个图在工程沟通上很有用，但它容易误导你以为这些步骤彼此独立。</p><p>更贴近现实的说法是：文本布局是一套“从粗到细的分段（segmentation）”，再把结果重新组装成布局对象（可绘制、可测量、可命中）的过程。典型层级包括：</p><ul><li>段落：最粗粒度，决定断行的基本范围</li><li>样式 run：同一段落内按样式切分（字体、字号、粗细、斜体等）</li><li>bidi run：把逻辑顺序转换成视觉顺序所需的信息</li><li>字体覆盖与 script：同一段文字可能必须 fallback 到不同字体与脚本处理</li><li>shaping cluster：最细粒度的“可渲染单元”，它决定 glyph 与位置</li></ul><p>这套视角的工程价值是：你更容易定义排版缓存与增量更新的边界——缓存单位不是“字符”，而是 run/cluster/line 这类可复用的对象；而 hit testing/selection 也自然落在“布局对象暴露的映射关系”之上，而不是在 DOM 上硬猜。</p><p>如果你还想再看点“反直觉但很真实”的坑，<code>Text Rendering Hates You</code> 会把很多边界条件讲得非常直白：文字不是字符，字形会跨边界，抗锯齿不是可组合的，缓存随便做就会被次像素偏移打爆。你会更理解为什么编辑器的排版系统必须对“正确性”和“性能”同时负责。</p><h2 id="参考与引用" tabindex="-1">参考与引用 <a class="header-anchor" href="#参考与引用" aria-label="Permalink to &quot;参考与引用&quot;">​</a></h2><ol><li>Knuth–Plass line breaking（TeX 排版思想，概念参考）：<a href="https://www.eprg.org/G53DOC/pdfs/knuth-plass-breaking.pdf" target="_blank" rel="noreferrer">https://www.eprg.org/G53DOC/pdfs/knuth-plass-breaking.pdf</a> （Bib: <code>knuth_plass</code>）</li><li>CSS Inline Layout Module：<a href="https://www.w3.org/TR/css-inline-3/" target="_blank" rel="noreferrer">https://www.w3.org/TR/css-inline-3/</a> （Bib: <code>css_inline_3</code>）</li><li>CSS Flexbox：<a href="https://www.w3.org/TR/css-flexbox-1/" target="_blank" rel="noreferrer">https://www.w3.org/TR/css-flexbox-1/</a> （Bib: <code>css_flexbox_1</code>）</li><li>OpenType metrics（排版指标基础）：<a href="https://learn.microsoft.com/en-us/typography/opentype/spec/otff" target="_blank" rel="noreferrer">https://learn.microsoft.com/en-us/typography/opentype/spec/otff</a> （Bib: <code>opentype_spec</code>）</li><li>Text layout is a loose hierarchy of segmentation：<a href="https://raphlinus.github.io/text/2020/10/26/text-layout.html" target="_blank" rel="noreferrer">https://raphlinus.github.io/text/2020/10/26/text-layout.html</a> （Bib: <code>text_layout_loose_hierarchy</code>）</li><li>Text Rendering Hates You：<a href="https://faultlore.com/blah/text-hates-you/" target="_blank" rel="noreferrer">https://faultlore.com/blah/text-hates-you/</a> （Bib: <code>text_hates_you</code>）</li><li>Web Browser Engineering：<a href="https://browser.engineering/" target="_blank" rel="noreferrer">https://browser.engineering/</a> （Bib: <code>web_browser_engineering</code>）</li></ol></div></div></main><footer class="VPDocFooter" data-v-55d9feae data-v-56184811><!--[--><!--]--><div class="edit-info" data-v-56184811><!----><div class="last-updated" data-v-56184811><p class="VPLastUpdated" data-v-56184811 data-v-849a375e>Last updated: <time datetime="2026-01-21T20:13:49.000Z" data-v-849a375e></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-56184811><span class="visually-hidden" id="doc-footer-aria-label" data-v-56184811>Pager</span><div class="pager" data-v-56184811><a class="VPLink link pager-link prev" href="/web-editor/08-images-history-and-secrets" data-v-56184811><!--[--><span class="desc" data-v-56184811>Previous page</span><span class="title" data-v-56184811>图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能</span><!--]--></a></div><div class="pager" data-v-56184811><a class="VPLink link pager-link next" href="/web-editor/10-unicode-linebreak-bidi-grapheme" data-v-56184811><!--[--><span class="desc" data-v-56184811>Next page</span><span class="title" data-v-56184811>Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"DyVshCfW\",\"about.prev.md\":\"597GxILS\",\"about.reference.md\":\"ByaC_d4S\",\"ai-chitchat_01-ai-core-intuition.md\":\"V8H1wclf\",\"ai-chitchat_02-diffusion-principle.md\":\"Idm6ye8z\",\"ai-chitchat_03-ecommerce-practice.md\":\"NA5-Q3qH\",\"ai-chitchat_04-engineering-paradigm.md\":\"yCOd0d9D\",\"browser-rendering_01-chromium-architecture-processes-and-threads.md\":\"DsJS60U3\",\"browser-rendering_02-blink-lifecycle-style-layout-paint.md\":\"xA0fFQ-6\",\"browser-rendering_03-cc-compositor-commit-activate-draw.md\":\"7Bmwa6Sw\",\"browser-rendering_04-viz-gpu-and-present-to-screen.md\":\"_CxNCmj-\",\"browser-rendering_05-input-latency-scroll-and-hit-test.md\":\"B-5vNstS\",\"browser-rendering_06-v8-for-frontend-hiddenclass-ic-gc.md\":\"DHID4y2I\",\"browser-rendering_07-workers-offscreen-canvas-and-transfer-cost.md\":\"rMMyMmli\",\"browser-rendering_08-performance-tracing-devtools-perfetto.md\":\"Wx8TVTEP\",\"browser-rendering_09-frontend-levers-css-composite-paint-budget.md\":\"BA_AjO5P\",\"browser-rendering___outline.md\":\"DpwKIuN_\",\"data-systems___outline.md\":\"B45QYMT9\",\"ds-algorithms___outline.md\":\"D3Y433Q0\",\"frontend-architecture___outline.md\":\"DxI8aP5l\",\"index.md\":\"DD4YgxjY\",\"js-core___outline.md\":\"CB4tIsXw\",\"okr_2021.md\":\"deYcZw_4\",\"okr_2022.md\":\"B_JUpneV\",\"okr_2023.md\":\"oC4DYVGP\",\"okr_2024.md\":\"DMrvr2D7\",\"performance___outline.md\":\"BsJR2FvL\",\"ten-years_2025-aigc-interview-notes.md\":\"D18BhWNq\",\"ten-years_2025-core-plus-plugins.md\":\"PKxokmTm\",\"ten-years_2025-release-patterns.md\":\"B5akt1ef\",\"ten-years_2025.md\":\"C1YvbifJ\",\"web-editor_01-editor-architecture.md\":\"vjlrosSW\",\"web-editor_02-collaboration-crdt-ot.md\":\"CUutVa6h\",\"web-editor_03-plugin-system.md\":\"Cukgr8KN\",\"web-editor_04-doc-storage-and-indexes.md\":\"Cwic9sDY\",\"web-editor_05-versioning-and-incremental-sync.md\":\"CCnHZl0T\",\"web-editor_06-open-source-editors-comparison.md\":\"b2eieCYN\",\"web-editor_07-fonts-history-and-secrets.md\":\"BkJdG9J6\",\"web-editor_08-images-history-and-secrets.md\":\"Bir1KWCa\",\"web-editor_09-layout-algorithms-constraint.md\":\"CiKt2lJB\",\"web-editor_10-unicode-linebreak-bidi-grapheme.md\":\"GNOYqyKz\",\"web-editor_11-hit-testing-and-event-system.md\":\"DZX37h-j\",\"web-editor_12-rendering-graphics-details.md\":\"Di0TvR_9\",\"web-editor___outline.md\":\"CjNuMFXE\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"2026\",\"description\":\"Book preview from source/_posts/2026\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"sidebar\":[{\"text\":\"目录\",\"collapsed\":false,\"items\":[{\"text\":\"引序\",\"link\":\"/\"},{\"text\":\"Web 编辑器与协同\",\"collapsed\":true,\"items\":[{\"text\":\"Web 编辑器：核心架构与“轮点”演进\",\"link\":\"/web-editor/01-editor-architecture\"},{\"text\":\"协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）\",\"link\":\"/web-editor/02-collaboration-crdt-ot\"},{\"text\":\"Web 编辑器插件体系：可扩展、可治理、可兜底\",\"link\":\"/web-editor/03-plugin-system\"},{\"text\":\"Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树\",\"link\":\"/web-editor/04-doc-storage-and-indexes\"},{\"text\":\"Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统\",\"link\":\"/web-editor/05-versioning-and-incremental-sync\"},{\"text\":\"开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill\",\"link\":\"/web-editor/06-open-source-editors-comparison\"},{\"text\":\"字体发展史与字体的秘密：从 OpenType 到编辑器排版管线\",\"link\":\"/web-editor/07-fonts-history-and-secrets\"},{\"text\":\"图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能\",\"link\":\"/web-editor/08-images-history-and-secrets\"},{\"text\":\"约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”\",\"link\":\"/web-editor/09-layout-algorithms-constraint\"},{\"text\":\"Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break\",\"link\":\"/web-editor/10-unicode-linebreak-bidi-grapheme\"},{\"text\":\"点击测试（Hit Testing）与事件系统：从坐标到交互闭环\",\"link\":\"/web-editor/11-hit-testing-and-event-system\"},{\"text\":\"渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）\",\"link\":\"/web-editor/12-rendering-graphics-details\"}]},{\"text\":\"浏览器底层与图形渲染\",\"collapsed\":true,\"items\":[{\"text\":\"Chromium 架构总览：多进程与线程模型\",\"link\":\"/browser-rendering/01-chromium-architecture-processes-and-threads\"},{\"text\":\"Blink 生命周期：style/layout/paint 与无效化\",\"link\":\"/browser-rendering/02-blink-lifecycle-style-layout-paint\"},{\"text\":\"cc 合成体系：两棵树、属性树与同步点\",\"link\":\"/browser-rendering/03-cc-compositor-commit-activate-draw\"},{\"text\":\"Viz/GPU/上屏：surface、buffer 与显示路径\",\"link\":\"/browser-rendering/04-viz-gpu-and-present-to-screen\"},{\"text\":\"输入与滚动：事件路由、命中与延迟下限\",\"link\":\"/browser-rendering/05-input-latency-scroll-and-hit-test\"},{\"text\":\"V8 细节（前端视角）：优化、deopt 与 GC\",\"link\":\"/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc\"},{\"text\":\"Worker：收益边界、OffscreenCanvas 与通信成本\",\"link\":\"/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost\"},{\"text\":\"可观测：DevTools、Tracing/Perfetto 与归因方法\",\"link\":\"/browser-rendering/08-performance-tracing-devtools-perfetto\"},{\"text\":\"前端对照表：哪些写法对应哪条渲染管线\",\"link\":\"/browser-rendering/09-frontend-levers-css-composite-paint-budget\"}]},{\"text\":\"AI 碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"AI 核心直觉：从梯度下降到 Transformer\",\"link\":\"/ai-chitchat/01-ai-core-intuition\"},{\"text\":\"图像生成原理：扩散模型与 Latent Space\",\"link\":\"/ai-chitchat/02-diffusion-principle\"},{\"text\":\"电商实战：AIGC 图文生产与 Agent 落地\",\"link\":\"/ai-chitchat/03-ecommerce-practice\"},{\"text\":\"工程范式：Vibe Coding 与 AI 时代的研发心法\",\"link\":\"/ai-chitchat/04-engineering-paradigm\"}]},{\"text\":\"工作的碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"2015-2025：十年技术路（面试速记版）\",\"link\":\"/ten-years/2025-aigc-interview-notes\"},{\"text\":\"为什么重交互产品都长成 Core + Plugins\",\"link\":\"/ten-years/2025-core-plus-plugins\"},{\"text\":\"四种发版节奏对比\",\"link\":\"/ten-years/2025-release-patterns\"},{\"text\":\"2025：十年再回首我的工作经历\",\"link\":\"/ten-years/2025\"}]}]}],\"outline\":\"deep\",\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>