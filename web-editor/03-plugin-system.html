<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web 编辑器插件体系：可扩展、可治理、可兜底 | 2026</title>
    <meta name="description" content="Book preview from source/_posts/2026">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.6EKIstcX.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.Bso63iIU.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.C2eRlmqf.js">
    <link rel="modulepreload" href="/assets/chunks/theme.DCpQ2QuC.js">
    <link rel="modulepreload" href="/assets/chunks/katex.Cu_Erd72.js">
    <link rel="modulepreload" href="/assets/chunks/dagre-6UL2VRFP.BFr-1k-S.js">
    <link rel="modulepreload" href="/assets/chunks/cose-bilkent-S5V4N54A.952tlhg_.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-YG6GDRKO.DJDoM6Cm.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-NV44I4VS.8UjvoLhx.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-Q2GNP2WA.DH1u6FgO.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-NY62KEGX.jlCf3R_H.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-JELNMOA3.CZgfnBqX.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-WHAUD3N6.9O8PMNgL.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-ADFJNKIX.CvivRrUo.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-AYHSOK5B.CYAHyuGF.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-PRI3JC2R.2qRh1mZp.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-UZGBJVZJ.D4rhye_D.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-WL72ISMW.DLD5kSuQ.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-2ON5EDUG.B8T-0mV_.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-WZHVMYZB.B8T-0mV_.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-FKZM4ZOC.BuQSdABs.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-4FDKWEC3.Bllkh3KV.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-XKPGCS4Q.CyEMTvVq.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-IT6M3QCI.Cj3VBXgM.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-VGOIOE7T.BlOxQaRC.js">
    <link rel="modulepreload" href="/assets/chunks/kanban-definition-3W4ZIXB7.KPcQZidX.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-TZEHDZUN.D5-Ji_W1.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-S2PKOQOG.6C4KPmag.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-QEK2KX5R.Bcb48A6e.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-VD42YOAC.CGDcZKdu.js">
    <link rel="modulepreload" href="/assets/chunks/architectureDiagram-VXUJARFQ.CXTM2sn3.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-PSM6KHXK.DHLm6Z1z.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/web-editor_03-plugin-system.md.DNyk1ILk.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-7e31dfad><!--[--><!--]--><!--[--><span tabindex="-1" data-v-39971c1e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-39971c1e>Skip to content</a><!--]--><!----><header class="VPNav" data-v-7e31dfad data-v-777e29d8><div class="VPNavBar" data-v-777e29d8 data-v-28354aa7><div class="wrapper" data-v-28354aa7><div class="container" data-v-28354aa7><div class="title" data-v-28354aa7><div class="VPNavBarTitle has-sidebar" data-v-28354aa7 data-v-7aef3d92><a class="title" href="/" data-v-7aef3d92><!--[--><!--]--><!----><span data-v-7aef3d92>2026</span><!--[--><!--]--></a></div></div><div class="content" data-v-28354aa7><div class="content-body" data-v-28354aa7><!--[--><!--]--><div class="VPNavBarSearch search" data-v-28354aa7><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-28354aa7 data-v-ac871bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ac871bc4 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-28354aa7 data-v-554c9a17 data-v-195e553c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-195e553c><span class="vpi-more-horizontal icon" data-v-195e553c></span></button><div class="menu" data-v-195e553c><div class="VPMenu" data-v-195e553c data-v-d91ff435><!----><!--[--><!--[--><!----><div class="group" data-v-554c9a17><div class="item appearance" data-v-554c9a17><p class="label" data-v-554c9a17>Appearance</p><div class="appearance-action" data-v-554c9a17><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-554c9a17 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-28354aa7 data-v-c95a1bd1><span class="container" data-v-c95a1bd1><span class="top" data-v-c95a1bd1></span><span class="middle" data-v-c95a1bd1></span><span class="bottom" data-v-c95a1bd1></span></span></button></div></div></div></div><div class="divider" data-v-28354aa7><div class="divider-line" data-v-28354aa7></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-7e31dfad data-v-d1d97dc0><div class="container" data-v-d1d97dc0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d1d97dc0><span class="vpi-align-left menu-icon" data-v-d1d97dc0></span><span class="menu-text" data-v-d1d97dc0>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-d1d97dc0 data-v-4833277d><button data-v-4833277d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-7e31dfad data-v-3fd06dd3><div class="curtain" data-v-3fd06dd3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fd06dd3><span class="visually-hidden" id="sidebar-aria-label" data-v-3fd06dd3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-efbd6156><section class="VPSidebarItem level-0 collapsible has-active" data-v-efbd6156 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h2 class="text" data-v-46688d19>目录</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/" data-v-46688d19><!--[--><p class="text" data-v-46688d19>引序</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed has-active" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>Web 编辑器与协同</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/01-editor-architecture" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器：核心架构与“轮点”演进</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/02-collaboration-crdt-ot" data-v-46688d19><!--[--><p class="text" data-v-46688d19>协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/03-plugin-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器插件体系：可扩展、可治理、可兜底</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/04-doc-storage-and-indexes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/05-versioning-and-incremental-sync" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/06-open-source-editors-comparison" data-v-46688d19><!--[--><p class="text" data-v-46688d19>开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/07-fonts-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>字体发展史与字体的秘密：从 OpenType 到编辑器排版管线</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/08-images-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/09-layout-algorithms-constraint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/10-unicode-linebreak-bidi-grapheme" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/11-hit-testing-and-event-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>点击测试（Hit Testing）与事件系统：从坐标到交互闭环</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/12-rendering-graphics-details" data-v-46688d19><!--[--><p class="text" data-v-46688d19>渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>浏览器底层与图形渲染</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/01-chromium-architecture-processes-and-threads" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Chromium 架构总览：多进程与线程模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/02-blink-lifecycle-style-layout-paint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Blink 生命周期：style/layout/paint 与无效化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/03-cc-compositor-commit-activate-draw" data-v-46688d19><!--[--><p class="text" data-v-46688d19>cc 合成体系：两棵树、属性树与同步点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/04-viz-gpu-and-present-to-screen" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Viz/GPU/上屏：surface、buffer 与显示路径</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/05-input-latency-scroll-and-hit-test" data-v-46688d19><!--[--><p class="text" data-v-46688d19>输入与滚动：事件路由、命中与延迟下限</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc" data-v-46688d19><!--[--><p class="text" data-v-46688d19>V8 细节（前端视角）：优化、deopt 与 GC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Worker：收益边界、OffscreenCanvas 与通信成本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/08-performance-tracing-devtools-perfetto" data-v-46688d19><!--[--><p class="text" data-v-46688d19>可观测：DevTools、Tracing/Perfetto 与归因方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/09-frontend-levers-css-composite-paint-budget" data-v-46688d19><!--[--><p class="text" data-v-46688d19>前端对照表：哪些写法对应哪条渲染管线</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>AI 碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/01-ml-dl-basics-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/02-diffusion-models-primer" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/03-ecommerce-diffusion-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/04-llm-primer-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/05-ecommerce-llm-agent-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/06-ai-positioning-and-engineering-playbook" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/07-vibecoding-three-horses-faster" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>工作的碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-core-plus-plugins" data-v-46688d19><!--[--><p class="text" data-v-46688d19>为什么重交互产品都长成 Core + Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-release-patterns" data-v-46688d19><!--[--><p class="text" data-v-46688d19>四种发版节奏对比</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2025：十年再回首我的工作经历</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-7e31dfad data-v-cfc5462b><div class="VPDoc has-sidebar has-aside" data-v-cfc5462b data-v-55d9feae><!--[--><!--]--><div class="container" data-v-55d9feae><div class="aside" data-v-55d9feae><div class="aside-curtain" data-v-55d9feae></div><div class="aside-container" data-v-55d9feae><div class="aside-content" data-v-55d9feae><div class="VPDocAside" data-v-55d9feae data-v-af649e6a><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-af649e6a data-v-bc4063f9><div class="content" data-v-bc4063f9><div class="outline-marker" data-v-bc4063f9></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-bc4063f9>On this page</div><ul class="VPDocOutlineItem root" data-v-bc4063f9 data-v-9f82df79><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-af649e6a></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-55d9feae><div class="content-container" data-v-55d9feae><!--[--><!--]--><main class="main" data-v-55d9feae><div style="position:relative;" class="vp-doc _web-editor_03-plugin-system" data-v-55d9feae><div><div class="alert read-stats" role="note"><span class="read-stats__icon" aria-hidden="true">🔖</span><span class="read-stats__text">本文约 <b>3718</b> 字，阅读预计耗时 <b>10</b> 分钟。</span></div><div class="alert ai-disclosure" role="note"><span class="ai-disclosure__icon" aria-hidden="true">ⓘ</span><span class="ai-disclosure__text">AI 辅助写作声明：本文由博主构思逻辑，AI 辅助润色，双方共同校对。</span></div><p>插件体系说白了就是“开后门”：开得好是生态，开不好是线上事故。</p><h2 id="问题-为什么编辑器的插件越多-越容易变成-不可控的怪物" tabindex="-1">问题：为什么编辑器的插件越多，越容易变成“不可控的怪物”？ <a class="header-anchor" href="#问题-为什么编辑器的插件越多-越容易变成-不可控的怪物" aria-label="Permalink to &quot;问题：为什么编辑器的插件越多，越容易变成“不可控的怪物”？&quot;">​</a></h2><p>编辑器不像普通页面组件：它持续接收输入、持续变更状态、持续重渲染。插件插进来以后，往往同时参与三条管道：</p><ul><li>输入（拦截键盘/粘贴）</li><li>状态（改 transaction）</li><li>渲染（加装饰器/节点视图）</li></ul><p>如果插件没有治理：</p><ul><li>一个插件的异常可能让整个编辑器崩溃</li><li>多个插件同时改同一事务，顺序不确定，bug 像幽灵</li><li>插件渲染开销不可见，性能慢得很“玄学”</li></ul><h2 id="分析-插件体系要解决的三件事" tabindex="-1">分析：插件体系要解决的三件事 <a class="header-anchor" href="#分析-插件体系要解决的三件事" aria-label="Permalink to &quot;分析：插件体系要解决的三件事&quot;">​</a></h2><ol><li>可扩展：提供足够的扩展点（commands/input rules/decorations/node view）</li><li>可治理：插件的能力、开销、兼容性可控（权限/预算/版本矩阵）</li><li>可兜底：插件崩了，核心不崩；数据不脏；可回放定位</li></ol><h2 id="轮点-插件生态从野生到治理" tabindex="-1">“轮点”：插件生态从野生到治理 <a class="header-anchor" href="#轮点-插件生态从野生到治理" aria-label="Permalink to &quot;“轮点”：插件生态从野生到治理&quot;">​</a></h2><ul><li>轮点 0：插件就是一堆回调（能用就行）</li><li>轮点 1：插件有生命周期（init/apply/view/destroy），可预测</li><li>轮点 2：插件有边界（权限、预算、异常隔离），可治理</li><li>轮点 3：插件可观测（耗时、异常、影响面），可运维</li></ul><h3 id="插件生命周期图-源文件-assets-diagrams-plugin-lifecycle-mmd" tabindex="-1">插件生命周期图（源文件：<code>../assets/diagrams/plugin-lifecycle.mmd</code>） <a class="header-anchor" href="#插件生命周期图-源文件-assets-diagrams-plugin-lifecycle-mmd" aria-label="Permalink to &quot;插件生命周期图（源文件：`../assets/diagrams/plugin-lifecycle.mmd`）&quot;">​</a></h3><div class="mermaid"></div><h2 id="解决方案-插件接口要-像平台规则-而不是-像业务回调" tabindex="-1">解决方案：插件接口要“像平台规则”，而不是“像业务回调” <a class="header-anchor" href="#解决方案-插件接口要-像平台规则-而不是-像业务回调" aria-label="Permalink to &quot;解决方案：插件接口要“像平台规则”，而不是“像业务回调”&quot;">​</a></h2><p>插件体系做得好不好，差异往往不是“扩展点多不多”，而是它有没有把复杂度关进笼子里。</p><p>我更愿意把插件体系类比成“外卖平台”：</p><ul><li>核心编辑器是平台：负责订单流转（transaction）、履约（apply）、出餐展示（view）</li><li>插件是商家/骑手/广告位：能接入能力，但必须遵守平台协议（权限/预算/兼容）</li><li>治理是平台规则：不然你会遇到“一个商家把平台搞崩”的神奇事故</li></ul><p>因此一个“有边界”的插件接口，至少要把下面几件事写死（不是写在代码里，而是写在规则里）：</p><ul><li>插件必须有身份：name / version（用于排障、灰度、熔断）</li><li>插件声明能力：它想在哪条管道里插一脚（输入/状态/渲染）</li><li>插件允许失败：失败时核心要能继续（异常隔离、回退策略）</li><li>插件有预算：每次参与事务的成本上限（超了就降级/告警）</li></ul><h3 id="插件的-最小协议-可以用自然语言描述清楚" tabindex="-1">插件的“最小协议”可以用自然语言描述清楚 <a class="header-anchor" href="#插件的-最小协议-可以用自然语言描述清楚" aria-label="Permalink to &quot;插件的“最小协议”可以用自然语言描述清楚&quot;">​</a></h3><p>把一个插件看成四个可选钩子（对应前面的生命周期）：</p><ul><li>init：注册时做一次性初始化（比如注册快捷键、准备资源）</li><li>apply(tr, prevState) → nextState：参与状态线，接收事务并返回新状态</li><li>view.update(prevView, nextView)：参与渲染线，更新装饰器/节点视图等</li><li>destroy：卸载时清理（释放资源、解除监听）</li></ul><p>注意：这里最关键的一句话是“返回新状态”，而不是“去改 DOM”。DOM 属于渲染线的结果，插件直接改 DOM，就像商家直接改平台数据库：短期省事，长期事故。</p><h3 id="插件隔离与预算-用一个流程图讲清楚兜底策略" tabindex="-1">插件隔离与预算：用一个流程图讲清楚兜底策略 <a class="header-anchor" href="#插件隔离与预算-用一个流程图讲清楚兜底策略" aria-label="Permalink to &quot;插件隔离与预算：用一个流程图讲清楚兜底策略&quot;">​</a></h3><p>设单次插件参与事务的耗时为 C（毫秒），预算为 B（毫秒）。最朴素的规则是：</p><ul><li>若 C ≤ B：正常通过</li><li>若 C &gt; B：不中断编辑，但必须留下证据（记录、上报、可能降级）</li><li>若插件抛错：核心回退到 prevState，并记录插件名与错误</li></ul><div class="mermaid"></div><p>这里的“稳定顺序”是避免幽灵 bug 的第一要义：同样的输入，在不同机器/不同构建里结果不能变。工程上通常会用“注册顺序 + 优先级 + 固定排序”来保证确定性。</p><h3 id="可解释性-把一次事务的-参与插件集合-打印出来" tabindex="-1">可解释性：把一次事务的“参与插件集合”打印出来 <a class="header-anchor" href="#可解释性-把一次事务的-参与插件集合-打印出来" aria-label="Permalink to &quot;可解释性：把一次事务的“参与插件集合”打印出来&quot;">​</a></h3><p>排障时最怕的不是 bug，而是“谁动了我”。因此你需要一份“事务说明书”，它至少包含：</p><ul><li>本次事务的意图（用户输入、命令、粘贴来源）</li><li>steps 摘要（数量、类型、影响范围）</li><li>参与的插件列表（顺序、是否触发 apply/view、耗时、是否异常）</li></ul><p>比喻一下：这就是编辑器的“黑匣子”。不做黑匣子，你迟早会在协同场景里对着一份“偶现错乱”发呆。</p><h3 id="权限与兼容-插件治理不是口号-是可执行的-合同" tabindex="-1">权限与兼容：插件治理不是口号，是可执行的“合同” <a class="header-anchor" href="#权限与兼容-插件治理不是口号-是可执行的-合同" aria-label="Permalink to &quot;权限与兼容：插件治理不是口号，是可执行的“合同”&quot;">​</a></h3><p>建议把治理拆成三张表（写在规范里，落在运行时）：</p><ol><li>权限表（Capability）</li></ol><ul><li>读：doc / selection / metadata</li><li>写：transaction / command dispatch</li><li>外部：network / storage / clipboard</li></ul><ol start="2"><li>预算表（Budget）</li></ol><ul><li>apply 每次预算 B_apply</li><li>view.update 每次预算 B_view</li><li>装饰器/节点视图数量上限 N_max（避免渲染爆炸）</li></ul><ol start="3"><li>兼容矩阵（Compatibility）</li></ol><ul><li>核心版本范围（例如 core ∈ [a, b)）</li><li>插件版本与迁移策略（breaking change 必须显式声明）</li></ul><p>四舍五入：插件体系不是“给业务开后门”，而是“用协议把后门变成正门”。正门的特点是：可治理、可观测、可熔断、可迁移。</p><h2 id="横向比较-插件体系的主流设计" tabindex="-1">横向比较：插件体系的主流设计 <a class="header-anchor" href="#横向比较-插件体系的主流设计" aria-label="Permalink to &quot;横向比较：插件体系的主流设计&quot;">​</a></h2><table tabindex="0"><thead><tr><th>框架/方案</th><th>插件粒度</th><th>渲染扩展点</th><th>状态扩展点</th><th>治理难点</th></tr></thead><tbody><tr><td>ProseMirror</td><td>Plugin + NodeView</td><td>Decorations/NodeView</td><td>apply/appendTransaction</td><td>插件顺序、状态一致性</td></tr><tr><td>Slate</td><td>“全自定义”</td><td>React 组件</td><td>transforms/normalization</td><td>自由度高导致约束弱</td></tr><tr><td>Lexical</td><td>Plugin</td><td>Node/DecoratorNode</td><td>update listeners</td><td>生态演进中、API 稳定性</td></tr></tbody></table><h2 id="工程实践-插件治理清单-性能与异常" tabindex="-1">工程实践：插件治理清单（性能与异常） <a class="header-anchor" href="#工程实践-插件治理清单-性能与异常" aria-label="Permalink to &quot;工程实践：插件治理清单（性能与异常）&quot;">​</a></h2><ul><li>权限：允许插件做什么（读 doc、写 tr、读 selection、访问网络）</li><li>预算：每次 apply 的耗时预算、装饰器数量上限、节点视图数量上限</li><li>兼容：插件版本矩阵（核心版本 ↔ 插件版本），发布时做静态检查</li><li>兜底：插件异常隔离、熔断开关、降级模式（只读/纯文本模式）</li><li>观测：插件耗时分布、异常次数、影响范围（文档/用户/房间）</li></ul><h2 id="常见事故-插件把编辑器搞崩的三种姿势-以及怎么提前兜住" tabindex="-1">常见事故：插件把编辑器搞崩的三种姿势（以及怎么提前兜住） <a class="header-anchor" href="#常见事故-插件把编辑器搞崩的三种姿势-以及怎么提前兜住" aria-label="Permalink to &quot;常见事故：插件把编辑器搞崩的三种姿势（以及怎么提前兜住）&quot;">​</a></h2><p>很多“插件事故”不是因为插件写得烂，而是因为平台没给出明确的规则。下面三种姿势尤其高频：</p><ol><li>插件把状态改坏了，但你没法定位</li></ol><ul><li>表现：偶现丢字、撤销异常、协同对不上；重启又好了</li><li>根因：插件在 apply 里做了非确定性行为（依赖时间、随机、外部请求结果），导致“同一输入不同输出”</li><li>兜底：把 apply 约束成纯函数思路（同 tr+prevState 必须得到同 nextState），外部依赖放到异步通道并显式写入 meta</li></ul><ol start="2"><li>插件把性能拖死了，但你以为是浏览器</li></ol><ul><li>表现：输入掉帧，长文档越写越卡；偶现，且跟插件组合有关</li><li>根因：装饰器爆炸、节点视图过多、或某个插件在每个事务里做了 O(n) 扫描</li><li>兜底：预算不是装饰品。对每次 apply/view.update 计时并打点；超过阈值就告警 + 降级（例如暂停装饰器、只保留基础渲染）</li></ul><ol start="3"><li>插件崩溃导致编辑器不可用</li></ol><ul><li>表现：某个边界输入触发插件 throw，整页白屏或编辑器锁死</li><li>根因：异常穿透核心，或者核心状态被部分写入（半更新）</li><li>兜底：异常隔离 + 回退 prevState；必要时引入“熔断”——当同一插件在短时间内连续失败超过 N 次，自动禁用并提示用户</li></ul><h3 id="灰度与熔断-插件生态走向治理的分水岭" tabindex="-1">灰度与熔断：插件生态走向治理的分水岭 <a class="header-anchor" href="#灰度与熔断-插件生态走向治理的分水岭" aria-label="Permalink to &quot;灰度与熔断：插件生态走向治理的分水岭&quot;">​</a></h3><p>插件是生态资产，也是风险入口。工程上建议至少做两件事：</p><ul><li>灰度：插件发布按用户/文档/房间分桶灰度，观察异常率与耗时分布</li><li>熔断：以插件为维度做开关，支持运行时禁用；禁用后系统应当仍可编辑（哪怕降级）</li></ul><p>四舍五入：平台一旦允许“第三方代码参与事务”，你就要把它当成线上系统来做治理，而不是当成一段回调。</p><h2 id="权衡-插件自由度越大-核心越要-冷酷" tabindex="-1">权衡：插件自由度越大，核心越要“冷酷” <a class="header-anchor" href="#权衡-插件自由度越大-核心越要-冷酷" aria-label="Permalink to &quot;权衡：插件自由度越大，核心越要“冷酷”&quot;">​</a></h2><p>很多团队一开始会下意识把插件做成“万能回调”，因为业务接入快。但插件自由度越大，核心越要冷酷：要敢于拒绝、敢于降级、敢于让插件失败也不影响主流程。</p><p>这里有两个非常工程化、但能救命的原则：</p><ol><li>核心只承诺“协议”，不承诺“业务正确”</li></ol><ul><li>核心要做的是：保证 transaction 的确定性、保证状态能回放、保证异常不穿透</li><li>核心不该做的是：替插件兜业务语义（例如“这个节点一定要这么渲染”），否则治理边界会消失</li></ul><ol start="2"><li>插件要被当成“不可信输入源”</li></ol><p>插件和用户输入一样，都可能带来脏数据与异常。把这句话放进团队共识后，你会自然做出这些设计：</p><ul><li>插件写入必须过 schema 校验/normalize</li><li>插件输出必须可序列化（否则协同/回放会出现幽灵差异）</li><li>插件执行必须可观测（否则性能问题会被误判成浏览器锅）</li></ul><h2 id="细节-把-性能预算-写成可执行的规则" tabindex="-1">细节：把“性能预算”写成可执行的规则 <a class="header-anchor" href="#细节-把-性能预算-写成可执行的规则" aria-label="Permalink to &quot;细节：把“性能预算”写成可执行的规则&quot;">​</a></h2><p>很多人对预算的误解是“超了就报错”。更合理的做法是把预算变成分层策略：</p><ul><li>软预算（soft budget）：超过阈值记录与告警，但不影响编辑</li><li>硬预算（hard budget）：超过阈值直接跳过某些非关键路径（例如装饰器、非核心 overlay）</li></ul><p>你甚至可以把它写成一个简单的口头公式：</p><ul><li>本帧预算 ≈ 16.7ms（60FPS）</li><li>编辑器可用预算 ≈ 8ms（留一半给浏览器与布局）</li><li>插件预算总和 ≤ 2~4ms（剩下的要给排版/命中/渲染）</li></ul><p>这不是拍脑袋，而是把“用户体验”翻译成一个工程约束：如果插件把 8ms 吃光了，输入就会掉帧。</p><h2 id="生态-插件版本矩阵为什么一定要做" tabindex="-1">生态：插件版本矩阵为什么一定要做？ <a class="header-anchor" href="#生态-插件版本矩阵为什么一定要做" aria-label="Permalink to &quot;生态：插件版本矩阵为什么一定要做？&quot;">​</a></h2><p>插件体系一旦走向生态，你会遇到一个非常现实的问题：核心在迭代，插件也在迭代，用户在用的组合更在迭代。</p><p>如果没有版本矩阵，你会得到一种最难排的线上问题：</p><ul><li>某个插件在某个核心版本上偶现崩溃</li><li>换个核心版本又好了</li><li>同样的插件版本在不同用户环境表现不同</li></ul><p>版本矩阵的工程收益是“把偶现变成可控”：</p><ul><li>插件声明支持的核心版本范围</li><li>核心升级时做兼容性检查（哪怕只是静态检查与最小回归）</li><li>发布时把“组合爆炸”压缩到可验证的集合</li></ul><p>四舍五入：插件治理不是给插件上枷锁，而是给生态一条能长期走下去的路。</p><h2 id="落地-权限、沙箱与-最小可信接口" tabindex="-1">落地：权限、沙箱与“最小可信接口” <a class="header-anchor" href="#落地-权限、沙箱与-最小可信接口" aria-label="Permalink to &quot;落地：权限、沙箱与“最小可信接口”&quot;">​</a></h2><p>上面说了权限表与预算表，但很多团队会卡在“怎么落地”：浏览器里跑的都是同一份 JS，凭什么能阻止插件乱来？现实里你确实很难做到绝对隔离，但你可以把风险压到可接受范围。</p><p>一个可操作的策略是把插件分成两类：</p><ul><li><strong>同仓插件（第一方）</strong>：允许更深的扩展点，但仍然必须遵守确定性与预算（否则你只是在用插件掩盖核心设计缺陷）</li><li><strong>外部插件（第三方）</strong>：只允许走“最小可信接口”，禁止直接触达底层对象引用（例如不要把 doc 树的可变引用直接暴露出去）</li></ul><p>“最小可信接口”背后的直觉很简单：你宁愿让插件不够强，也不要让插件强到能把你的真相来源改坏。具体做法通常是把接口改成“消息式/声明式”：</p><ul><li>插件不拿 doc 的可变引用，只能拿到快照（序列化数据或只读视图）</li><li>插件不直接修改 transaction，只能返回“建议的变更”（由核心校验并决定是否采纳）</li><li>插件渲染不直接操作 DOM，只能提交“装饰声明”（核心负责合并、去重、裁剪）</li></ul><p>这样做的收益是：核心永远掌握最后的闸门。即便插件想乱写，也会被校验与 normalize 拦下来。</p><h2 id="安全与合规-把-访问外部世界-单独当成一条管道" tabindex="-1">安全与合规：把“访问外部世界”单独当成一条管道 <a class="header-anchor" href="#安全与合规-把-访问外部世界-单独当成一条管道" aria-label="Permalink to &quot;安全与合规：把“访问外部世界”单独当成一条管道&quot;">​</a></h2><p>编辑器插件最危险的能力通常不是改 doc，而是访问外部世界：网络请求、剪贴板、文件系统（尤其是桌面端壳层）、以及埋点上报。</p><p>建议把这些能力做成单独的受控通道：</p><ul><li>所有网络请求走统一代理（可加白名单、可打审计日志）</li><li>剪贴板读写必须显式授权（最好能在 UI 上可见，至少在日志里可见）</li><li>本地存储要有命名空间隔离（避免插件互相污染）</li></ul><p>工程上这相当于把“可观测性”前置：你不需要从一开始就实现完美沙箱，但你必须让风险行为可见、可追责、可快速关停。</p><h2 id="确定性-插件最容易破坏的其实是-同输入同输出" tabindex="-1">确定性：插件最容易破坏的其实是“同输入同输出” <a class="header-anchor" href="#确定性-插件最容易破坏的其实是-同输入同输出" aria-label="Permalink to &quot;确定性：插件最容易破坏的其实是“同输入同输出”&quot;">​</a></h2><p>插件体系的隐形底线是确定性：同一份文档、同一组输入事件、同一组插件集合，应该得到同样的结果。否则你会在协同、回放、甚至单机撤销里看到各种“幽灵差异”。</p><p>确定性最常见的破坏源不是算法，而是副作用：</p><ul><li>apply 阶段读时间、读随机数、读外部请求结果</li><li>依赖全局单例状态（例如某个共享缓存被别的插件改了）</li><li>在 apply 阶段做异步，并在未来某个时刻回写模型</li></ul><p>一个更稳的运行时约束是：插件的 apply 只允许产生“可序列化的状态变化”，任何外部依赖都必须显式进入 transaction 的 meta 或 payload。这样你才能把协同与回放建立在可推演的事实之上。</p><p>补一句：确定性不仅是为了协同，也是为了灰度与排障。当你能把“某次事务经过哪些插件、插件输出是什么”稳定记录下来，你才有可能在不同用户环境里重放出同一份结果。</p><p>同时它也会反过来影响你的 API 设计：如果某个扩展点天然需要读取外部世界，那它就不该放在 apply 里，而应该放在更外层的“异步输入管道”里，并把结果以显式数据写回事务。插件体系的成熟往往体现在这种“把副作用放到正确的层级”的自觉上。</p><h2 id="参考与引用" tabindex="-1">参考与引用 <a class="header-anchor" href="#参考与引用" aria-label="Permalink to &quot;参考与引用&quot;">​</a></h2><ol><li>ProseMirror Plugin API: <a href="https://prosemirror.net/docs/ref/" target="_blank" rel="noreferrer">https://prosemirror.net/docs/ref/</a> （Bib: <code>prosemirror_ref</code>）</li><li>Slate Concepts: <a href="https://docs.slatejs.org/" target="_blank" rel="noreferrer">https://docs.slatejs.org/</a> （Bib: <code>slate_docs</code>）</li><li>Lexical Docs: <a href="https://lexical.dev/docs" target="_blank" rel="noreferrer">https://lexical.dev/docs</a> （Bib: <code>lexical_docs</code>）</li></ol></div></div></main><footer class="VPDocFooter" data-v-55d9feae data-v-56184811><!--[--><!--]--><div class="edit-info" data-v-56184811><!----><div class="last-updated" data-v-56184811><p class="VPLastUpdated" data-v-56184811 data-v-849a375e>Last updated: <time datetime="2026-01-21T20:13:49.000Z" data-v-849a375e></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-56184811><span class="visually-hidden" id="doc-footer-aria-label" data-v-56184811>Pager</span><div class="pager" data-v-56184811><a class="VPLink link pager-link prev" href="/web-editor/02-collaboration-crdt-ot" data-v-56184811><!--[--><span class="desc" data-v-56184811>Previous page</span><span class="title" data-v-56184811>协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）</span><!--]--></a></div><div class="pager" data-v-56184811><a class="VPLink link pager-link next" href="/web-editor/04-doc-storage-and-indexes" data-v-56184811><!--[--><span class="desc" data-v-56184811>Next page</span><span class="title" data-v-56184811>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"BOuT5Xqj\",\"about.prev.md\":\"BQgxr-AH\",\"about.reference.md\":\"7t6c_gbk\",\"ai-chitchat_01-ml-dl-basics-for-engineers.md\":\"CSGKLUmh\",\"ai-chitchat_02-diffusion-models-primer.md\":\"CgXvcQH6\",\"ai-chitchat_03-ecommerce-diffusion-practice.md\":\"DNuKoPoL\",\"ai-chitchat_04-llm-primer-for-engineers.md\":\"DFj5j7et\",\"ai-chitchat_05-ecommerce-llm-agent-practice.md\":\"2OVUGGlq\",\"ai-chitchat_06-ai-positioning-and-engineering-playbook.md\":\"DOY1c6D9\",\"ai-chitchat_07-vibecoding-three-horses-faster.md\":\"Ckw94XWx\",\"ai-chitchat___outline.md\":\"BemGlInV\",\"browser-rendering_01-chromium-architecture-processes-and-threads.md\":\"DGnUA3U4\",\"browser-rendering_02-blink-lifecycle-style-layout-paint.md\":\"ZIXhYsvb\",\"browser-rendering_03-cc-compositor-commit-activate-draw.md\":\"Cex6WzAq\",\"browser-rendering_04-viz-gpu-and-present-to-screen.md\":\"ChNkp0-R\",\"browser-rendering_05-input-latency-scroll-and-hit-test.md\":\"eyEnLM1m\",\"browser-rendering_06-v8-for-frontend-hiddenclass-ic-gc.md\":\"CDR1x51v\",\"browser-rendering_07-workers-offscreen-canvas-and-transfer-cost.md\":\"CqWrNVIC\",\"browser-rendering_08-performance-tracing-devtools-perfetto.md\":\"AtPS6R68\",\"browser-rendering_09-frontend-levers-css-composite-paint-budget.md\":\"CkrrnGje\",\"browser-rendering___outline.md\":\"Bv1SlDU_\",\"data-systems___outline.md\":\"BmGU4eM0\",\"ds-algorithms___outline.md\":\"4wxr6wUW\",\"frontend-architecture___outline.md\":\"Cdxl7-6Z\",\"index.md\":\"CWShnum0\",\"js-core___outline.md\":\"DMBo0gev\",\"okr_2021.md\":\"Cxlsal38\",\"okr_2022.md\":\"DfSlpXrp\",\"okr_2023.md\":\"C2u0sLp9\",\"okr_2024.md\":\"BYqUlAws\",\"performance___outline.md\":\"DNRdWFUF\",\"ten-years_2025-core-plus-plugins.md\":\"v7DR0KfE\",\"ten-years_2025-release-patterns.md\":\"DQrIb2jd\",\"ten-years_2025.md\":\"Bclmut9b\",\"web-editor_01-editor-architecture.md\":\"lRsdKxVi\",\"web-editor_02-collaboration-crdt-ot.md\":\"C942o2Qf\",\"web-editor_03-plugin-system.md\":\"DNyk1ILk\",\"web-editor_04-doc-storage-and-indexes.md\":\"DzdXlCjz\",\"web-editor_05-versioning-and-incremental-sync.md\":\"hIpenErk\",\"web-editor_06-open-source-editors-comparison.md\":\"DDGZ3jWP\",\"web-editor_07-fonts-history-and-secrets.md\":\"BfZHC_lv\",\"web-editor_08-images-history-and-secrets.md\":\"DPcy_uLE\",\"web-editor_09-layout-algorithms-constraint.md\":\"DplBRr8f\",\"web-editor_10-unicode-linebreak-bidi-grapheme.md\":\"BEMy2SAO\",\"web-editor_11-hit-testing-and-event-system.md\":\"MqCg7gRd\",\"web-editor_12-rendering-graphics-details.md\":\"D01JXebS\",\"web-editor___outline.md\":\"DI1aAM5K\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"2026\",\"description\":\"Book preview from source/_posts/2026\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"sidebar\":[{\"text\":\"目录\",\"collapsed\":false,\"items\":[{\"text\":\"引序\",\"link\":\"/\"},{\"text\":\"Web 编辑器与协同\",\"collapsed\":true,\"items\":[{\"text\":\"Web 编辑器：核心架构与“轮点”演进\",\"link\":\"/web-editor/01-editor-architecture\"},{\"text\":\"协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）\",\"link\":\"/web-editor/02-collaboration-crdt-ot\"},{\"text\":\"Web 编辑器插件体系：可扩展、可治理、可兜底\",\"link\":\"/web-editor/03-plugin-system\"},{\"text\":\"Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树\",\"link\":\"/web-editor/04-doc-storage-and-indexes\"},{\"text\":\"Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统\",\"link\":\"/web-editor/05-versioning-and-incremental-sync\"},{\"text\":\"开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill\",\"link\":\"/web-editor/06-open-source-editors-comparison\"},{\"text\":\"字体发展史与字体的秘密：从 OpenType 到编辑器排版管线\",\"link\":\"/web-editor/07-fonts-history-and-secrets\"},{\"text\":\"图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能\",\"link\":\"/web-editor/08-images-history-and-secrets\"},{\"text\":\"约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”\",\"link\":\"/web-editor/09-layout-algorithms-constraint\"},{\"text\":\"Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break\",\"link\":\"/web-editor/10-unicode-linebreak-bidi-grapheme\"},{\"text\":\"点击测试（Hit Testing）与事件系统：从坐标到交互闭环\",\"link\":\"/web-editor/11-hit-testing-and-event-system\"},{\"text\":\"渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）\",\"link\":\"/web-editor/12-rendering-graphics-details\"}]},{\"text\":\"浏览器底层与图形渲染\",\"collapsed\":true,\"items\":[{\"text\":\"Chromium 架构总览：多进程与线程模型\",\"link\":\"/browser-rendering/01-chromium-architecture-processes-and-threads\"},{\"text\":\"Blink 生命周期：style/layout/paint 与无效化\",\"link\":\"/browser-rendering/02-blink-lifecycle-style-layout-paint\"},{\"text\":\"cc 合成体系：两棵树、属性树与同步点\",\"link\":\"/browser-rendering/03-cc-compositor-commit-activate-draw\"},{\"text\":\"Viz/GPU/上屏：surface、buffer 与显示路径\",\"link\":\"/browser-rendering/04-viz-gpu-and-present-to-screen\"},{\"text\":\"输入与滚动：事件路由、命中与延迟下限\",\"link\":\"/browser-rendering/05-input-latency-scroll-and-hit-test\"},{\"text\":\"V8 细节（前端视角）：优化、deopt 与 GC\",\"link\":\"/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc\"},{\"text\":\"Worker：收益边界、OffscreenCanvas 与通信成本\",\"link\":\"/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost\"},{\"text\":\"可观测：DevTools、Tracing/Perfetto 与归因方法\",\"link\":\"/browser-rendering/08-performance-tracing-devtools-perfetto\"},{\"text\":\"前端对照表：哪些写法对应哪条渲染管线\",\"link\":\"/browser-rendering/09-frontend-levers-css-composite-paint-budget\"}]},{\"text\":\"AI 碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）\",\"link\":\"/ai-chitchat/01-ml-dl-basics-for-engineers\"},{\"text\":\"AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）\",\"link\":\"/ai-chitchat/02-diffusion-models-primer\"},{\"text\":\"AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）\",\"link\":\"/ai-chitchat/03-ecommerce-diffusion-practice\"},{\"text\":\"AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）\",\"link\":\"/ai-chitchat/04-llm-primer-for-engineers\"},{\"text\":\"AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）\",\"link\":\"/ai-chitchat/05-ecommerce-llm-agent-practice\"},{\"text\":\"AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）\",\"link\":\"/ai-chitchat/06-ai-positioning-and-engineering-playbook\"},{\"text\":\"AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster\",\"link\":\"/ai-chitchat/07-vibecoding-three-horses-faster\"}]},{\"text\":\"工作的碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"为什么重交互产品都长成 Core + Plugins\",\"link\":\"/ten-years/2025-core-plus-plugins\"},{\"text\":\"四种发版节奏对比\",\"link\":\"/ten-years/2025-release-patterns\"},{\"text\":\"2025：十年再回首我的工作经历\",\"link\":\"/ten-years/2025\"}]}]}],\"outline\":\"deep\",\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>