<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树 | 2026</title>
    <meta name="description" content="Book preview from source/_posts/2026">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.6EKIstcX.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.aYPDotOZ.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.C2eRlmqf.js">
    <link rel="modulepreload" href="/assets/chunks/theme.NTViZsLq.js">
    <link rel="modulepreload" href="/assets/chunks/katex.Cu_Erd72.js">
    <link rel="modulepreload" href="/assets/chunks/dagre-6UL2VRFP.D_JPnozB.js">
    <link rel="modulepreload" href="/assets/chunks/cose-bilkent-S5V4N54A.BtPKS54n.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-YG6GDRKO.B1nW5L68.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-NV44I4VS.Dn_kgznt.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-Q2GNP2WA.BrRJ495e.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-NY62KEGX.clcrsUw8.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-JELNMOA3.CiHFD3YG.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-WHAUD3N6.-asrdDM4.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-ADFJNKIX.CVOJCSrD.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-AYHSOK5B.C_8vdWfh.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-PRI3JC2R.D2kIDVMM.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-UZGBJVZJ.CVl4uDN1.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-WL72ISMW.8RXGI-Rw.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-2ON5EDUG.CE0l8bc1.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-WZHVMYZB.CE0l8bc1.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-FKZM4ZOC.CA5IQzGs.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-4FDKWEC3.Vggxalbf.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-XKPGCS4Q.C3ryl38C.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-IT6M3QCI.-cgnbVjL.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-VGOIOE7T.CJp89pbC.js">
    <link rel="modulepreload" href="/assets/chunks/kanban-definition-3W4ZIXB7.CSi9P46W.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-TZEHDZUN.BJS5UnTj.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-S2PKOQOG.DIq1QZL2.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-QEK2KX5R.DxAAv5XD.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-VD42YOAC.CLgwzWys.js">
    <link rel="modulepreload" href="/assets/chunks/architectureDiagram-VXUJARFQ.mqOIk2Du.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-PSM6KHXK.acXplp5D.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/web-editor_04-doc-storage-and-indexes.md.DzdXlCjz.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-7e31dfad><!--[--><!--]--><!--[--><span tabindex="-1" data-v-39971c1e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-39971c1e>Skip to content</a><!--]--><!----><header class="VPNav" data-v-7e31dfad data-v-777e29d8><div class="VPNavBar" data-v-777e29d8 data-v-28354aa7><div class="wrapper" data-v-28354aa7><div class="container" data-v-28354aa7><div class="title" data-v-28354aa7><div class="VPNavBarTitle has-sidebar" data-v-28354aa7 data-v-7aef3d92><a class="title" href="/" data-v-7aef3d92><!--[--><!--]--><!----><span data-v-7aef3d92>2026</span><!--[--><!--]--></a></div></div><div class="content" data-v-28354aa7><div class="content-body" data-v-28354aa7><!--[--><!--]--><div class="VPNavBarSearch search" data-v-28354aa7><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-28354aa7 data-v-ac871bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ac871bc4 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-28354aa7 data-v-554c9a17 data-v-195e553c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-195e553c><span class="vpi-more-horizontal icon" data-v-195e553c></span></button><div class="menu" data-v-195e553c><div class="VPMenu" data-v-195e553c data-v-d91ff435><!----><!--[--><!--[--><!----><div class="group" data-v-554c9a17><div class="item appearance" data-v-554c9a17><p class="label" data-v-554c9a17>Appearance</p><div class="appearance-action" data-v-554c9a17><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-554c9a17 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-28354aa7 data-v-c95a1bd1><span class="container" data-v-c95a1bd1><span class="top" data-v-c95a1bd1></span><span class="middle" data-v-c95a1bd1></span><span class="bottom" data-v-c95a1bd1></span></span></button></div></div></div></div><div class="divider" data-v-28354aa7><div class="divider-line" data-v-28354aa7></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-7e31dfad data-v-d1d97dc0><div class="container" data-v-d1d97dc0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d1d97dc0><span class="vpi-align-left menu-icon" data-v-d1d97dc0></span><span class="menu-text" data-v-d1d97dc0>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-d1d97dc0 data-v-4833277d><button data-v-4833277d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-7e31dfad data-v-3fd06dd3><div class="curtain" data-v-3fd06dd3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fd06dd3><span class="visually-hidden" id="sidebar-aria-label" data-v-3fd06dd3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-efbd6156><section class="VPSidebarItem level-0 collapsible has-active" data-v-efbd6156 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h2 class="text" data-v-46688d19>目录</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/" data-v-46688d19><!--[--><p class="text" data-v-46688d19>引序</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed has-active" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>Web 编辑器与协同</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/01-editor-architecture" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器：核心架构与“轮点”演进</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/02-collaboration-crdt-ot" data-v-46688d19><!--[--><p class="text" data-v-46688d19>协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/03-plugin-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器插件体系：可扩展、可治理、可兜底</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/04-doc-storage-and-indexes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/05-versioning-and-incremental-sync" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/06-open-source-editors-comparison" data-v-46688d19><!--[--><p class="text" data-v-46688d19>开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/07-fonts-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>字体发展史与字体的秘密：从 OpenType 到编辑器排版管线</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/08-images-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/09-layout-algorithms-constraint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/10-unicode-linebreak-bidi-grapheme" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/11-hit-testing-and-event-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>点击测试（Hit Testing）与事件系统：从坐标到交互闭环</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/12-rendering-graphics-details" data-v-46688d19><!--[--><p class="text" data-v-46688d19>渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>浏览器底层与图形渲染</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/01-chromium-architecture-processes-and-threads" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Chromium 架构总览：多进程与线程模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/02-blink-lifecycle-style-layout-paint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Blink 生命周期：style/layout/paint 与无效化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/03-cc-compositor-commit-activate-draw" data-v-46688d19><!--[--><p class="text" data-v-46688d19>cc 合成体系：两棵树、属性树与同步点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/04-viz-gpu-and-present-to-screen" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Viz/GPU/上屏：surface、buffer 与显示路径</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/05-input-latency-scroll-and-hit-test" data-v-46688d19><!--[--><p class="text" data-v-46688d19>输入与滚动：事件路由、命中与延迟下限</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc" data-v-46688d19><!--[--><p class="text" data-v-46688d19>V8 细节（前端视角）：优化、deopt 与 GC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Worker：收益边界、OffscreenCanvas 与通信成本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/08-performance-tracing-devtools-perfetto" data-v-46688d19><!--[--><p class="text" data-v-46688d19>可观测：DevTools、Tracing/Perfetto 与归因方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/09-frontend-levers-css-composite-paint-budget" data-v-46688d19><!--[--><p class="text" data-v-46688d19>前端对照表：哪些写法对应哪条渲染管线</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>AI 碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/01-ml-dl-basics-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/02-diffusion-models-primer" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/03-ecommerce-diffusion-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/04-llm-primer-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/05-ecommerce-llm-agent-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/06-ai-positioning-and-engineering-playbook" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/07-vibecoding-three-horses-faster" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>工作的碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-core-plus-plugins" data-v-46688d19><!--[--><p class="text" data-v-46688d19>为什么重交互产品都长成 Core + Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-release-patterns" data-v-46688d19><!--[--><p class="text" data-v-46688d19>四种发版节奏对比</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2025：十年再回首我的工作经历</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-7e31dfad data-v-cfc5462b><div class="VPDoc has-sidebar has-aside" data-v-cfc5462b data-v-55d9feae><!--[--><!--]--><div class="container" data-v-55d9feae><div class="aside" data-v-55d9feae><div class="aside-curtain" data-v-55d9feae></div><div class="aside-container" data-v-55d9feae><div class="aside-content" data-v-55d9feae><div class="VPDocAside" data-v-55d9feae data-v-af649e6a><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-af649e6a data-v-bc4063f9><div class="content" data-v-bc4063f9><div class="outline-marker" data-v-bc4063f9></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-bc4063f9>On this page</div><ul class="VPDocOutlineItem root" data-v-bc4063f9 data-v-9f82df79><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-af649e6a></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-55d9feae><div class="content-container" data-v-55d9feae><!--[--><!--]--><main class="main" data-v-55d9feae><div style="position:relative;" class="vp-doc _web-editor_04-doc-storage-and-indexes" data-v-55d9feae><div><div class="alert read-stats" role="note"><span class="read-stats__icon" aria-hidden="true">🔖</span><span class="read-stats__text">本文约 <b>2723</b> 字，阅读预计耗时 <b>7</b> 分钟。</span></div><div class="alert ai-disclosure" role="note"><span class="ai-disclosure__icon" aria-hidden="true">ⓘ</span><span class="ai-disclosure__text">AI 辅助写作声明：本文由博主构思逻辑，AI 辅助润色，双方共同校对。</span></div><p>编辑器的数据结构，属于那种“平时看不见，一出事就要命”的底层活：性能抖一下，用户第一反应是“卡”；数据错一下，用户第二反应是“你赔我稿子”。</p><h2 id="问题-编辑器的文档到底怎么存-才能既快又稳" tabindex="-1">问题：编辑器的文档到底怎么存，才能既快又稳？ <a class="header-anchor" href="#问题-编辑器的文档到底怎么存-才能既快又稳" aria-label="Permalink to &quot;问题：编辑器的文档到底怎么存，才能既快又稳？&quot;">​</a></h2><p>直觉做法是：用一个大字符串存全文，插入就 <code>slice + concat</code>，删除也一样。</p><p>然后你会发现：</p><ul><li>每次插入一个字符都在复制 O(n) 的字符串，长文档直接原地升天</li><li>你想支持 undo/redo，就要保存一堆大字符串快照，内存爆炸</li><li>你想做协同，要记录操作日志（op log），但每次回放如果都靠全量字符串拼接，回放性能会崩</li><li>你想做高亮、批注、标记范围（ranges/decorations），查询“某个位置命中了哪些范围”会变成线性扫，越用越慢</li></ul><p>究其根本：编辑器的数据不是“文本”，而是“文本 + 结构 + 元信息（range/decoration）”。你需要两类东西：</p><ol><li>文本存储结构：让插入/删除/切片/回放更便宜</li><li>区间索引结构：让范围查询/命中判断更便宜</li></ol><p>这篇文章讲两条主线：</p><ul><li>文本：Rope / Piece Table / Gap Buffer 的取舍</li><li>范围：Interval Tree（很多实现会落在红黑树上）在编辑器里怎么发挥作用</li></ul><h2 id="分析-三种文本存储结构-横向对比" tabindex="-1">分析：三种文本存储结构（横向对比） <a class="header-anchor" href="#分析-三种文本存储结构-横向对比" aria-label="Permalink to &quot;分析：三种文本存储结构（横向对比）&quot;">​</a></h2><table tabindex="0"><thead><tr><th>结构</th><th>核心思想</th><th>插入/删除成本</th><th>适用场景</th><th>常见坑</th></tr></thead><tbody><tr><td>Gap Buffer</td><td>光标附近留一个“空洞”</td><td>光标附近快，远距离慢</td><td>纯文本、单光标编辑</td><td>多光标/大范围编辑时移动 gap 代价大</td></tr><tr><td>Piece Table</td><td>原文不动，新插入放增量 buffer，用 piece 指向片段</td><td>操作成本靠 split/merge</td><td>编辑器主流思路之一</td><td>piece 碎片化，需要合并/压缩</td></tr><tr><td>Rope</td><td>平衡树存片段，支持高效拼接/切分</td><td>依赖树平衡</td><td>长文本、高并发修改</td><td>常数项大，实现复杂，调试困难</td></tr></tbody></table><p>四舍五入：如果你要做“富文本编辑器”，最终通常会走向 <strong>Piece Table 或 Rope</strong>（或者“树结构的 Piece Table”）。</p><h2 id="解决方案-1-piece-table-编辑器的工程甜点" tabindex="-1">解决方案 1：Piece Table（编辑器的工程甜点） <a class="header-anchor" href="#解决方案-1-piece-table-编辑器的工程甜点" aria-label="Permalink to &quot;解决方案 1：Piece Table（编辑器的工程甜点）&quot;">​</a></h2><p>Piece Table 的关键点是：<strong>原始文本不改动</strong>，新插入的文本追加到 addBuffer，文档内容由一张“片段表”拼出来。</p><h3 id="piece-table-数据流图-源文件-assets-diagrams-doc-storage-piece-table-mmd" tabindex="-1">Piece Table 数据流图（源文件：<code>../assets/diagrams/doc-storage-piece-table.mmd</code>） <a class="header-anchor" href="#piece-table-数据流图-源文件-assets-diagrams-doc-storage-piece-table-mmd" aria-label="Permalink to &quot;Piece Table 数据流图（源文件：`../assets/diagrams/doc-storage-piece-table.mmd`）&quot;">​</a></h3><div class="mermaid"></div><h3 id="piece-table-的-几何感-你在维护一张目录-而不是在改正文" tabindex="-1">Piece Table 的“几何感”：你在维护一张目录，而不是在改正文 <a class="header-anchor" href="#piece-table-的-几何感-你在维护一张目录-而不是在改正文" aria-label="Permalink to &quot;Piece Table 的“几何感”：你在维护一张目录，而不是在改正文&quot;">​</a></h3><p>把 Piece Table 想成三件东西：</p><ul><li>Original Buffer：档案馆里的原始稿纸，只读不改</li><li>Add Buffer：桌上的便签本，只追加不回头</li><li>Pieces：目录索引，按顺序指向“从哪一张纸抄哪一段”</li></ul><p>因此一次编辑不是“修改正文”，而是“修改目录”。这也是它能快的根本原因：目录变了，正文不需要整段复制。</p><p>为了能把算法讲清楚，我们用更抽象的记号描述一个 piece：</p><ul><li>piece = (buf, off, len)</li><li>buf ∈ {OB, AB} 分别指向 Original/Add</li><li>文档内容 = 依次拼接所有 piece 指向的片段</li></ul><h4 id="插入算法-自然语言版" tabindex="-1">插入算法（自然语言版） <a class="header-anchor" href="#插入算法-自然语言版" aria-label="Permalink to &quot;插入算法（自然语言版）&quot;">​</a></h4><p>输入：全局位置 p，插入文本 x。</p><ol><li>把 x 追加到 Add Buffer 末尾，得到它在 Add Buffer 中的区间 [a, a+|x|)</li><li>在 Pieces 上定位全局位置 p 落在哪个 piece 里（这一步决定了你能不能做到快）</li><li>把命中的 piece 在 p 处切成 left / right 两段</li><li>把 insertPiece=(AB, a, |x|) 插到 left 与 right 中间</li></ol><p>这里最“数学”的一句话其实就是切分：</p><ul><li>原 piece： (buf, off, len)</li><li>切分点 k（k 是该 piece 内部偏移，0≤k≤len）</li><li>left = (buf, off, k)，right = (buf, off+k, len-k)</li></ul><p>插入的复杂度主要来自两件事：</p><ul><li>定位：找到 p（如果线性扫 pieces，就是 O(#pieces)）</li><li>结构变更：切分与插入（通常是 O(1) 级别的结构操作，但依赖你 pieces 的容器）</li></ul><h4 id="删除算法-自然语言版" tabindex="-1">删除算法（自然语言版） <a class="header-anchor" href="#删除算法-自然语言版" aria-label="Permalink to &quot;删除算法（自然语言版）&quot;">​</a></h4><p>输入：删除区间 [l, r)。</p><ol><li>在 Pieces 上定位 l 与 r，各自落在哪些 pieces</li><li>对边界 pieces 做切分，把 [l, r) 的边界对齐到 piece 边界</li><li>删除所有完全落入 [l, r) 的 pieces</li><li>可能触发合并：相邻、同 buffer、连续 offset 的 pieces 可以合成一段（减少碎片）</li></ol><p>为了让插入/删除更“可视化”，给一个简化流程图：</p><div class="mermaid"></div><h3 id="碎片化-piece-table-的-甜点-会变成-饼干渣" tabindex="-1">碎片化：Piece Table 的“甜点”会变成“饼干渣” <a class="header-anchor" href="#碎片化-piece-table-的-甜点-会变成-饼干渣" aria-label="Permalink to &quot;碎片化：Piece Table 的“甜点”会变成“饼干渣”&quot;">​</a></h3><p>Piece Table 最大的工程副作用就是碎片化：每一次插入/删除都会切分 pieces，久而久之 pieces 会变得很碎。</p><p>碎到什么程度会出事？通常不是“用户看得出来”，而是系统会出现两类退化：</p><ul><li>定位退化：按全局位置找到命中 piece，如果你还是线性扫 pieces，会越来越慢</li><li>materialize 退化：渲染与导出时需要拼接更多片段，常数项变大，缓存命中率下降</li></ul><p>把它类比成图书馆的“目录卡片”：</p><ul><li>一开始每本书一张卡片（pieces 很少）</li><li>后来你把每一章都拆成单独卡片</li><li>再后来你把每一页也拆成单独卡片</li></ul><p>目录当然还能用，但查询与整理会越来越痛苦。</p><p>因此工程上通常会有一个明确的“整理策略”（compaction / merge），它不追求每次都最优，而追求：</p><ul><li>当碎片达到阈值时，把相邻可合并的 pieces 合并</li><li>当 addBuffer 过大或碎片过多时，做一次重写（rebuild）：把当前文档 materialize 成新 original，再清空 addBuffer</li></ul><p>一句话：Piece Table 的性能不是永远免费的，它需要你在后台做“打扫卫生”。</p><h3 id="按位置定位-为什么你迟早会把-pieces-做成树" tabindex="-1">按位置定位：为什么你迟早会把 pieces 做成树 <a class="header-anchor" href="#按位置定位-为什么你迟早会把-pieces-做成树" aria-label="Permalink to &quot;按位置定位：为什么你迟早会把 pieces 做成树&quot;">​</a></h3><p>很多人第一版都会把 pieces 存在数组里，定位靠线性扫。它确实能跑，但长文档迟早会逼你改结构。</p><p>目标很简单：把“按位置定位”从 O(#pieces) 变成 O(log #pieces)。</p><p>做法也很朴素：把 pieces 放进一棵平衡树，并在每个节点上缓存子树长度（subtreeLen）：</p><ul><li>subtreeLen(node) = subtreeLen(left) + len(piece(node)) + subtreeLen(right)</li></ul><p>这样你就可以用“走树”的方式定位位置 p：</p><ul><li>若 p &lt; subtreeLen(left)：去左子树</li><li>若 p 落在当前 piece：返回命中</li><li>否则 p := p - subtreeLen(left) - len(current)，去右子树</li></ul><p>这类结构不一定要叫 Rope，但它表达的工程意图是一样的：用树把定位成本压下去，把长文档从“偶尔卡”变成“稳定可控”。</p><h4 id="piece-table-的工程取舍-纵向深入两层" tabindex="-1">Piece Table 的工程取舍（纵向深入两层） <a class="header-anchor" href="#piece-table-的工程取舍-纵向深入两层" aria-label="Permalink to &quot;Piece Table 的工程取舍（纵向深入两层）&quot;">​</a></h4><ul><li>第一层（数据结构层）：插入/删除变成对 pieces 的 split/merge，避免复制大字符串</li><li>第二层（系统层）：undo/redo 不需要存整份文本，只需要存“结构变更（pieces 的增删改）”或“操作日志”</li></ul><p>以及它最现实的坑：</p><ul><li>碎片化：大量小插入会产生很多 piece，导致遍历、定位、渲染变慢</li><li>需要索引：findPieceAt 是线性扫，长文档会慢，需要“位置索引”（例如在树节点上缓存子树长度）</li></ul><p>这时你会走向 Rope（或者“树形 piece table”）。</p><h2 id="解决方案-2-rope-用平衡树给-piece-table-上索引" tabindex="-1">解决方案 2：Rope（用平衡树给 Piece Table 上索引） <a class="header-anchor" href="#解决方案-2-rope-用平衡树给-piece-table-上索引" aria-label="Permalink to &quot;解决方案 2：Rope（用平衡树给 Piece Table 上索引）&quot;">​</a></h2><p>Rope 的本质是：用一棵平衡树存片段，节点缓存子树长度，让“按位置定位”从 O(n) 变成 O(log n)。</p><p>现实工程里，你不一定要“标准 Rope”，只要满足两点就行：</p><ul><li>结构：树 + 可拆分/可拼接</li><li>索引：每个节点维护 <code>subtreeLength</code>，支持按位置走树</li></ul><h2 id="解决方案-3-区间树-红黑树-编辑器-range-的命脉" tabindex="-1">解决方案 3：区间树/红黑树（编辑器 range 的命脉） <a class="header-anchor" href="#解决方案-3-区间树-红黑树-编辑器-range-的命脉" aria-label="Permalink to &quot;解决方案 3：区间树/红黑树（编辑器 range 的命脉）&quot;">​</a></h2><p>编辑器里大量元信息是“区间”：</p><ul><li>高亮（syntax highlight）</li><li>批注（comment）</li><li>装饰器（decoration）</li><li>协同光标（remote cursor）</li><li>选区（selection）</li></ul><p>它们共同特征是：需要回答“某个位置/范围命中了哪些区间”。</p><p>朴素方案是线性扫：O(m)。m 一大就卡。</p><p>区间树（Interval Tree）的常见实现是：<strong>用一棵平衡 BST（例如红黑树）按 <code>start</code> 排序，每个节点维护子树 <code>maxEnd</code></strong>，从而能在 O(log m + k) 找到所有相交区间（k 是输出数量）。</p><h3 id="区间树示意图-源文件-assets-diagrams-interval-tree-mmd" tabindex="-1">区间树示意图（源文件：<code>../assets/diagrams/interval-tree.mmd</code>） <a class="header-anchor" href="#区间树示意图-源文件-assets-diagrams-interval-tree-mmd" aria-label="Permalink to &quot;区间树示意图（源文件：`../assets/diagrams/interval-tree.mmd`）&quot;">​</a></h3><div class="mermaid"></div><h3 id="区间树查询为什么能快-maxend-的剪枝逻辑-口语版" tabindex="-1">区间树查询为什么能快：maxEnd 的剪枝逻辑（口语版） <a class="header-anchor" href="#区间树查询为什么能快-maxend-的剪枝逻辑-口语版" aria-label="Permalink to &quot;区间树查询为什么能快：maxEnd 的剪枝逻辑（口语版）&quot;">​</a></h3><p>区间树节点按 start 排序，同时每个节点缓存子树的 maxEnd。查询一个范围 Q=[qₛ, qₑ] 时，你在树上做三件事：</p><ol><li>先看左子树：如果 left.maxEnd &lt; qₛ，那么左子树所有区间都结束得太早，必不相交，直接剪掉</li><li>再看当前节点：若 node.start ≤ qₑ 且 node.end ≥ qₛ，则与 Q 相交</li><li>再看右子树：如果 node.start &gt; qₑ，那么右子树 start 更大，只会更不可能相交，也可以剪掉</li></ol><p>它看起来像一堆 if，但背后是非常朴素的事实：</p><ul><li>你只要证明“这一整片子树不可能命中”，就能把线性扫描变成对数级搜索</li><li>编辑器里 ranges 动态增删，红黑树之类的平衡树确保最坏情况也不炸（这点很重要，线上事故往往来自最坏情况）</li></ul><h4 id="红黑树在这里发挥什么作用" tabindex="-1">红黑树在这里发挥什么作用？ <a class="header-anchor" href="#红黑树在这里发挥什么作用" aria-label="Permalink to &quot;红黑树在这里发挥什么作用？&quot;">​</a></h4><p>编辑器场景下，ranges 是动态的：增删频繁、数量很大、需要稳定的最坏复杂度。</p><ul><li>红黑树提供稳定的 O(log n) 插入/删除/查找（最坏也不炸）</li><li>区间树把 “maxEnd 缓存” 挂在红黑树节点上，就能把范围查询也变成可控复杂度</li></ul><p>一句话总结：红黑树不是“让你写出更帅的数据结构”，它是为了让线上性能不要因为最坏情况变成事故。</p><h2 id="工程实践-把-位置-作为第一公民-增量维护" tabindex="-1">工程实践：把“位置”作为第一公民（增量维护） <a class="header-anchor" href="#工程实践-把-位置-作为第一公民-增量维护" aria-label="Permalink to &quot;工程实践：把“位置”作为第一公民（增量维护）&quot;">​</a></h2><p>到这里，你会发现编辑器里最难的是：位置不是稳定的。</p><ul><li>文档插入一个字符后，后面的所有 range 都要平移</li><li>如果你每次都把所有区间做一次 <code>start/end</code> 加偏移，会是 O(m)</li></ul><p>解决思路通常是两条：</p><ol><li>维护映射（mapping）：把变更抽象成 step，能把旧位置映射到新位置</li><li>分段存储：range 索引按块维护，变更只影响局部块，并可延迟计算全量偏移</li></ol><h2 id="什么时候用-rope-什么时候用-piece-table-不要被名字绑架" tabindex="-1">什么时候用 Rope，什么时候用 Piece Table：不要被名字绑架 <a class="header-anchor" href="#什么时候用-rope-什么时候用-piece-table-不要被名字绑架" aria-label="Permalink to &quot;什么时候用 Rope，什么时候用 Piece Table：不要被名字绑架&quot;">​</a></h2><p>实际落地时，你经常会发现“数据结构名词”并不能直接指导工程选型，因为真正决定体验的是几件更具体的事：</p><ul><li>你的主要操作模式是什么：连续输入（小插入高频）还是大段粘贴/删除（大范围变更）</li><li>你是否需要多光标/多选区：多光标会显著放大“按位置定位”的次数</li><li>你是否需要频繁切片：例如导出、搜索、语法高亮，都在大量读取子串</li></ul><p>一个更贴地的判断标准是把成本拆开：定位成本 + 结构变更成本 + materialize 成本。</p><ul><li>如果定位是 O(#pieces) 的线性扫，#pieces 一旦增长，你会在长文档里体验到“越写越慢”</li><li>如果 materialize 每次都拼很多片段，常数项会把你拖进 GC 与缓存 miss 的泥潭</li></ul><p>所以很多工程最终会走向一种折中：前台用树索引保证定位稳定（近似 Rope 的结构），后台用 compaction 保持碎片不过度膨胀（近似 Piece Table 的工程策略）。</p><h2 id="compaction-的常见策略-打扫卫生也要讲方法" tabindex="-1">Compaction 的常见策略：打扫卫生也要讲方法 <a class="header-anchor" href="#compaction-的常见策略-打扫卫生也要讲方法" aria-label="Permalink to &quot;Compaction 的常见策略：打扫卫生也要讲方法&quot;">​</a></h2><p>整理不是越频繁越好，否则你会把本该平滑的编辑体验变成“偶尔一次大卡顿”。更常见的策略是分层触发：</p><ul><li><strong>阈值触发</strong>：当 #pieces 超过阈值，或平均片段长度低于阈值，触发一次局部合并</li><li><strong>空闲触发</strong>：在 idle/后台线程里做更重的重写（rebuild），避免抢占输入帧预算</li><li><strong>快照触发</strong>：协同/历史系统本来就需要快照窗口，重写可以顺便把“当前状态”固化为新 original</li></ul><p>你可以把一次重写理解成把“目录卡片”重新装订成一本干净的新书：它不是为了每次都最省内存，而是为了把最坏情况限制住，让系统长期运行仍然稳定。</p><h2 id="让范围索引跟得上编辑-别让-decoration-成为性能黑洞" tabindex="-1">让范围索引跟得上编辑：别让 decoration 成为性能黑洞 <a class="header-anchor" href="#让范围索引跟得上编辑-别让-decoration-成为性能黑洞" aria-label="Permalink to &quot;让范围索引跟得上编辑：别让 decoration 成为性能黑洞&quot;">​</a></h2><p>很多编辑器性能问题并不是“文本存储慢”，而是装饰器/高亮/批注这类 ranges 越积越多，最终把每次输入拖进大量区间更新与查询。你如果把范围索引当成“附加功能”，它会在长文档里变成主成本。</p><p>更稳的工程拆法是让 ranges 的维护也走“增量”：</p><ul><li>每次编辑得到一个变更 step（插入/删除/结构移动）</li><li>用 step 把旧区间映射到新区间（start/end 可能平移、收缩、或被切断）</li><li>只有映射后仍然有效的区间才继续进入索引结构</li></ul><p>这件事的意义是把“区间更新”从 O(m) 的全量平移，变成只影响局部、且可被 step 描述的变更。四舍五入：你越早把 range 索引当成一等公民，越不容易在后期被“高亮越多越卡”逼着重写。</p><h2 id="参考与引用" tabindex="-1">参考与引用 <a class="header-anchor" href="#参考与引用" aria-label="Permalink to &quot;参考与引用&quot;">​</a></h2><ol><li>ProseMirror 位置映射与 step 体系：<a href="https://prosemirror.net/docs/ref/" target="_blank" rel="noreferrer">https://prosemirror.net/docs/ref/</a> （Bib: <code>prosemirror_ref</code>）</li><li>Wikipedia: Piece table：<a href="https://en.wikipedia.org/wiki/Piece_table" target="_blank" rel="noreferrer">https://en.wikipedia.org/wiki/Piece_table</a> （Bib: <code>piece_table_wikipedia</code>）</li><li>Wikipedia: Rope (data structure)：<a href="https://en.wikipedia.org/wiki/Rope_(data_structure)" target="_blank" rel="noreferrer">https://en.wikipedia.org/wiki/Rope_(data_structure)</a> （Bib: <code>rope_wikipedia</code>）</li><li>MIT OpenCourseWare / Interval Trees（概念性资料，便于补齐 maxEnd 思路）：<a href="https://ocw.mit.edu/" target="_blank" rel="noreferrer">https://ocw.mit.edu/</a> （Bib: <code>interval_tree_mit_ocw</code>）</li></ol></div></div></main><footer class="VPDocFooter" data-v-55d9feae data-v-56184811><!--[--><!--]--><div class="edit-info" data-v-56184811><!----><div class="last-updated" data-v-56184811><p class="VPLastUpdated" data-v-56184811 data-v-849a375e>Last updated: <time datetime="2026-01-21T20:13:49.000Z" data-v-849a375e></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-56184811><span class="visually-hidden" id="doc-footer-aria-label" data-v-56184811>Pager</span><div class="pager" data-v-56184811><a class="VPLink link pager-link prev" href="/web-editor/03-plugin-system" data-v-56184811><!--[--><span class="desc" data-v-56184811>Previous page</span><span class="title" data-v-56184811>Web 编辑器插件体系：可扩展、可治理、可兜底</span><!--]--></a></div><div class="pager" data-v-56184811><a class="VPLink link pager-link next" href="/web-editor/05-versioning-and-incremental-sync" data-v-56184811><!--[--><span class="desc" data-v-56184811>Next page</span><span class="title" data-v-56184811>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"BOuT5Xqj\",\"about.prev.md\":\"BQgxr-AH\",\"about.reference.md\":\"7t6c_gbk\",\"ai-chitchat_01-ml-dl-basics-for-engineers.md\":\"CSGKLUmh\",\"ai-chitchat_02-diffusion-models-primer.md\":\"CgXvcQH6\",\"ai-chitchat_03-ecommerce-diffusion-practice.md\":\"DNuKoPoL\",\"ai-chitchat_04-llm-primer-for-engineers.md\":\"DFj5j7et\",\"ai-chitchat_05-ecommerce-llm-agent-practice.md\":\"2OVUGGlq\",\"ai-chitchat_06-ai-positioning-and-engineering-playbook.md\":\"DOY1c6D9\",\"ai-chitchat_07-vibecoding-three-horses-faster.md\":\"Ckw94XWx\",\"ai-chitchat___outline.md\":\"BemGlInV\",\"browser-rendering_01-chromium-architecture-processes-and-threads.md\":\"DGnUA3U4\",\"browser-rendering_02-blink-lifecycle-style-layout-paint.md\":\"ZIXhYsvb\",\"browser-rendering_03-cc-compositor-commit-activate-draw.md\":\"Cex6WzAq\",\"browser-rendering_04-viz-gpu-and-present-to-screen.md\":\"ChNkp0-R\",\"browser-rendering_05-input-latency-scroll-and-hit-test.md\":\"eyEnLM1m\",\"browser-rendering_06-v8-for-frontend-hiddenclass-ic-gc.md\":\"CDR1x51v\",\"browser-rendering_07-workers-offscreen-canvas-and-transfer-cost.md\":\"CqWrNVIC\",\"browser-rendering_08-performance-tracing-devtools-perfetto.md\":\"AtPS6R68\",\"browser-rendering_09-frontend-levers-css-composite-paint-budget.md\":\"CkrrnGje\",\"browser-rendering___outline.md\":\"Bv1SlDU_\",\"data-systems___outline.md\":\"BmGU4eM0\",\"ds-algorithms___outline.md\":\"4wxr6wUW\",\"frontend-architecture___outline.md\":\"Cdxl7-6Z\",\"index.md\":\"CWShnum0\",\"js-core___outline.md\":\"DMBo0gev\",\"okr_2021.md\":\"Cxlsal38\",\"okr_2022.md\":\"DfSlpXrp\",\"okr_2023.md\":\"C2u0sLp9\",\"okr_2024.md\":\"BYqUlAws\",\"performance___outline.md\":\"DNRdWFUF\",\"ten-years_2025-core-plus-plugins.md\":\"v7DR0KfE\",\"ten-years_2025-release-patterns.md\":\"DQrIb2jd\",\"ten-years_2025.md\":\"Bclmut9b\",\"web-editor_01-editor-architecture.md\":\"lRsdKxVi\",\"web-editor_02-collaboration-crdt-ot.md\":\"C942o2Qf\",\"web-editor_03-plugin-system.md\":\"DNyk1ILk\",\"web-editor_04-doc-storage-and-indexes.md\":\"DzdXlCjz\",\"web-editor_05-versioning-and-incremental-sync.md\":\"hIpenErk\",\"web-editor_06-open-source-editors-comparison.md\":\"DDGZ3jWP\",\"web-editor_07-fonts-history-and-secrets.md\":\"BfZHC_lv\",\"web-editor_08-images-history-and-secrets.md\":\"DPcy_uLE\",\"web-editor_09-layout-algorithms-constraint.md\":\"DplBRr8f\",\"web-editor_10-unicode-linebreak-bidi-grapheme.md\":\"BEMy2SAO\",\"web-editor_11-hit-testing-and-event-system.md\":\"MqCg7gRd\",\"web-editor_12-rendering-graphics-details.md\":\"D01JXebS\",\"web-editor___outline.md\":\"DI1aAM5K\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"2026\",\"description\":\"Book preview from source/_posts/2026\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"sidebar\":[{\"text\":\"目录\",\"collapsed\":false,\"items\":[{\"text\":\"引序\",\"link\":\"/\"},{\"text\":\"Web 编辑器与协同\",\"collapsed\":true,\"items\":[{\"text\":\"Web 编辑器：核心架构与“轮点”演进\",\"link\":\"/web-editor/01-editor-architecture\"},{\"text\":\"协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）\",\"link\":\"/web-editor/02-collaboration-crdt-ot\"},{\"text\":\"Web 编辑器插件体系：可扩展、可治理、可兜底\",\"link\":\"/web-editor/03-plugin-system\"},{\"text\":\"Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树\",\"link\":\"/web-editor/04-doc-storage-and-indexes\"},{\"text\":\"Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统\",\"link\":\"/web-editor/05-versioning-and-incremental-sync\"},{\"text\":\"开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill\",\"link\":\"/web-editor/06-open-source-editors-comparison\"},{\"text\":\"字体发展史与字体的秘密：从 OpenType 到编辑器排版管线\",\"link\":\"/web-editor/07-fonts-history-and-secrets\"},{\"text\":\"图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能\",\"link\":\"/web-editor/08-images-history-and-secrets\"},{\"text\":\"约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”\",\"link\":\"/web-editor/09-layout-algorithms-constraint\"},{\"text\":\"Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break\",\"link\":\"/web-editor/10-unicode-linebreak-bidi-grapheme\"},{\"text\":\"点击测试（Hit Testing）与事件系统：从坐标到交互闭环\",\"link\":\"/web-editor/11-hit-testing-and-event-system\"},{\"text\":\"渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）\",\"link\":\"/web-editor/12-rendering-graphics-details\"}]},{\"text\":\"浏览器底层与图形渲染\",\"collapsed\":true,\"items\":[{\"text\":\"Chromium 架构总览：多进程与线程模型\",\"link\":\"/browser-rendering/01-chromium-architecture-processes-and-threads\"},{\"text\":\"Blink 生命周期：style/layout/paint 与无效化\",\"link\":\"/browser-rendering/02-blink-lifecycle-style-layout-paint\"},{\"text\":\"cc 合成体系：两棵树、属性树与同步点\",\"link\":\"/browser-rendering/03-cc-compositor-commit-activate-draw\"},{\"text\":\"Viz/GPU/上屏：surface、buffer 与显示路径\",\"link\":\"/browser-rendering/04-viz-gpu-and-present-to-screen\"},{\"text\":\"输入与滚动：事件路由、命中与延迟下限\",\"link\":\"/browser-rendering/05-input-latency-scroll-and-hit-test\"},{\"text\":\"V8 细节（前端视角）：优化、deopt 与 GC\",\"link\":\"/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc\"},{\"text\":\"Worker：收益边界、OffscreenCanvas 与通信成本\",\"link\":\"/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost\"},{\"text\":\"可观测：DevTools、Tracing/Perfetto 与归因方法\",\"link\":\"/browser-rendering/08-performance-tracing-devtools-perfetto\"},{\"text\":\"前端对照表：哪些写法对应哪条渲染管线\",\"link\":\"/browser-rendering/09-frontend-levers-css-composite-paint-budget\"}]},{\"text\":\"AI 碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）\",\"link\":\"/ai-chitchat/01-ml-dl-basics-for-engineers\"},{\"text\":\"AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）\",\"link\":\"/ai-chitchat/02-diffusion-models-primer\"},{\"text\":\"AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）\",\"link\":\"/ai-chitchat/03-ecommerce-diffusion-practice\"},{\"text\":\"AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）\",\"link\":\"/ai-chitchat/04-llm-primer-for-engineers\"},{\"text\":\"AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）\",\"link\":\"/ai-chitchat/05-ecommerce-llm-agent-practice\"},{\"text\":\"AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）\",\"link\":\"/ai-chitchat/06-ai-positioning-and-engineering-playbook\"},{\"text\":\"AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster\",\"link\":\"/ai-chitchat/07-vibecoding-three-horses-faster\"}]},{\"text\":\"工作的碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"为什么重交互产品都长成 Core + Plugins\",\"link\":\"/ten-years/2025-core-plus-plugins\"},{\"text\":\"四种发版节奏对比\",\"link\":\"/ten-years/2025-release-patterns\"},{\"text\":\"2025：十年再回首我的工作经历\",\"link\":\"/ten-years/2025\"}]}]}],\"outline\":\"deep\",\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>