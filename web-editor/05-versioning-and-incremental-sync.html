<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统 | 2026</title>
    <meta name="description" content="Book preview from source/_posts/2026">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.KvBkxlqs.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CT58ZVeS.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.BAs4fWuZ.js">
    <link rel="modulepreload" href="/assets/chunks/theme.DlFEq6KP.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/web-editor_05-versioning-and-incremental-sync.md.CCnHZl0T.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><!----><!--teleport anchor--><!--teleport start anchor--><!----><!--teleport anchor-->
    <div id="app"><div class="Layout" data-v-7e31dfad><!--[--><!--]--><!--[--><span tabindex="-1" data-v-39971c1e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-39971c1e>Skip to content</a><!--]--><!----><header class="VPNav" data-v-7e31dfad data-v-777e29d8><div class="VPNavBar" data-v-777e29d8 data-v-28354aa7><div class="wrapper" data-v-28354aa7><div class="container" data-v-28354aa7><div class="title" data-v-28354aa7><div class="VPNavBarTitle has-sidebar" data-v-28354aa7 data-v-7aef3d92><a class="title" href="/" data-v-7aef3d92><!--[--><!--]--><!----><span data-v-7aef3d92>2026</span><!--[--><!--]--></a></div></div><div class="content" data-v-28354aa7><div class="content-body" data-v-28354aa7><!--[--><!--]--><div class="VPNavBarSearch search" data-v-28354aa7><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-28354aa7 data-v-ac871bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ac871bc4 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-28354aa7 data-v-554c9a17 data-v-195e553c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-195e553c><span class="vpi-more-horizontal icon" data-v-195e553c></span></button><div class="menu" data-v-195e553c><div class="VPMenu" data-v-195e553c data-v-d91ff435><!----><!--[--><!--[--><!----><div class="group" data-v-554c9a17><div class="item appearance" data-v-554c9a17><p class="label" data-v-554c9a17>Appearance</p><div class="appearance-action" data-v-554c9a17><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-554c9a17 data-v-f556f0c8 data-v-0f2dd873><span class="check" data-v-0f2dd873><span class="icon" data-v-0f2dd873><!--[--><span class="vpi-sun sun" data-v-f556f0c8></span><span class="vpi-moon moon" data-v-f556f0c8></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-28354aa7 data-v-c95a1bd1><span class="container" data-v-c95a1bd1><span class="top" data-v-c95a1bd1></span><span class="middle" data-v-c95a1bd1></span><span class="bottom" data-v-c95a1bd1></span></span></button></div></div></div></div><div class="divider" data-v-28354aa7><div class="divider-line" data-v-28354aa7></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-7e31dfad data-v-d1d97dc0><div class="container" data-v-d1d97dc0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-d1d97dc0><span class="vpi-align-left menu-icon" data-v-d1d97dc0></span><span class="menu-text" data-v-d1d97dc0>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-d1d97dc0 data-v-4833277d><button data-v-4833277d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-7e31dfad data-v-3fd06dd3><div class="curtain" data-v-3fd06dd3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-3fd06dd3><span class="visually-hidden" id="sidebar-aria-label" data-v-3fd06dd3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-efbd6156><section class="VPSidebarItem level-0 collapsible has-active" data-v-efbd6156 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h2 class="text" data-v-46688d19>目录</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-1 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/" data-v-46688d19><!--[--><p class="text" data-v-46688d19>引序</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed has-active" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>Web 编辑器与协同</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/01-editor-architecture" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器：核心架构与“轮点”演进</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/02-collaboration-crdt-ot" data-v-46688d19><!--[--><p class="text" data-v-46688d19>协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/03-plugin-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器插件体系：可扩展、可治理、可兜底</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/04-doc-storage-and-indexes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/05-versioning-and-incremental-sync" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/06-open-source-editors-comparison" data-v-46688d19><!--[--><p class="text" data-v-46688d19>开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/07-fonts-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>字体发展史与字体的秘密：从 OpenType 到编辑器排版管线</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/08-images-history-and-secrets" data-v-46688d19><!--[--><p class="text" data-v-46688d19>图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/09-layout-algorithms-constraint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/10-unicode-linebreak-bidi-grapheme" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/11-hit-testing-and-event-system" data-v-46688d19><!--[--><p class="text" data-v-46688d19>点击测试（Hit Testing）与事件系统：从坐标到交互闭环</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/web-editor/12-rendering-graphics-details" data-v-46688d19><!--[--><p class="text" data-v-46688d19>渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>浏览器底层与图形渲染</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/01-chromium-architecture-processes-and-threads" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Chromium 架构总览：多进程与线程模型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/02-blink-lifecycle-style-layout-paint" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Blink 生命周期：style/layout/paint 与无效化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/03-cc-compositor-commit-activate-draw" data-v-46688d19><!--[--><p class="text" data-v-46688d19>cc 合成体系：两棵树、属性树与同步点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/04-viz-gpu-and-present-to-screen" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Viz/GPU/上屏：surface、buffer 与显示路径</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/05-input-latency-scroll-and-hit-test" data-v-46688d19><!--[--><p class="text" data-v-46688d19>输入与滚动：事件路由、命中与延迟下限</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc" data-v-46688d19><!--[--><p class="text" data-v-46688d19>V8 细节（前端视角）：优化、deopt 与 GC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost" data-v-46688d19><!--[--><p class="text" data-v-46688d19>Worker：收益边界、OffscreenCanvas 与通信成本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/08-performance-tracing-devtools-perfetto" data-v-46688d19><!--[--><p class="text" data-v-46688d19>可观测：DevTools、Tracing/Perfetto 与归因方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/browser-rendering/09-frontend-levers-css-composite-paint-budget" data-v-46688d19><!--[--><p class="text" data-v-46688d19>前端对照表：哪些写法对应哪条渲染管线</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>AI 碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/01-ml-dl-basics-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/02-diffusion-models-primer" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/03-ecommerce-diffusion-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/04-llm-primer-for-engineers" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/05-ecommerce-llm-agent-practice" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/06-ai-positioning-and-engineering-playbook" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ai-chitchat/07-vibecoding-three-horses-faster" data-v-46688d19><!--[--><p class="text" data-v-46688d19>AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-46688d19 data-v-46688d19><div class="item" role="button" tabindex="0" data-v-46688d19><div class="indicator" data-v-46688d19></div><h3 class="text" data-v-46688d19>工作的碎碎念</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-46688d19><span class="vpi-chevron-right caret-icon" data-v-46688d19></span></div></div><div class="items" data-v-46688d19><!--[--><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-aigc-interview-notes" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2024-2025：字节电商 AIGC（面试速记版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-core-plus-plugins" data-v-46688d19><!--[--><p class="text" data-v-46688d19>为什么重交互产品都长成 Core + Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025-release-patterns" data-v-46688d19><!--[--><p class="text" data-v-46688d19>四种发版节奏对比</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-46688d19 data-v-46688d19><div class="item" data-v-46688d19><div class="indicator" data-v-46688d19></div><a class="VPLink link link" href="/ten-years/2025" data-v-46688d19><!--[--><p class="text" data-v-46688d19>2025：十年再回首我的工作经历</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-7e31dfad data-v-cfc5462b><div class="VPDoc has-sidebar has-aside" data-v-cfc5462b data-v-55d9feae><!--[--><!--]--><div class="container" data-v-55d9feae><div class="aside" data-v-55d9feae><div class="aside-curtain" data-v-55d9feae></div><div class="aside-container" data-v-55d9feae><div class="aside-content" data-v-55d9feae><div class="VPDocAside" data-v-55d9feae data-v-af649e6a><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-af649e6a data-v-bc4063f9><div class="content" data-v-bc4063f9><div class="outline-marker" data-v-bc4063f9></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-bc4063f9>On this page</div><ul class="VPDocOutlineItem root" data-v-bc4063f9 data-v-9f82df79><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-af649e6a></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-55d9feae><div class="content-container" data-v-55d9feae><!--[--><!--]--><main class="main" data-v-55d9feae><div style="position:relative;" class="vp-doc _web-editor_05-versioning-and-incremental-sync" data-v-55d9feae><div><div class="alert read-stats" role="note"><span class="read-stats__icon" aria-hidden="true">🔖</span><span class="read-stats__text">本文约 <b>3482</b> 字，阅读预计耗时 <b>9</b> 分钟。</span></div><div class="alert ai-disclosure" role="note"><span class="ai-disclosure__icon" aria-hidden="true">ⓘ</span><span class="ai-disclosure__text">AI 辅助写作声明：本文由博主构思逻辑，AI 辅助润色，双方共同校对。</span></div><p>协同/版本管理这块，最容易出现一种错觉：demo 跑通了就以为“做完了”。上线后才开始遇到：重连丢操作、回放卡死、偶现错位、以及用户问你“我刚刚那段文字去哪了”。</p><h2 id="问题-编辑器的-增量提交-到底提交的是什么" tabindex="-1">问题：编辑器的“增量提交”到底提交的是什么？ <a class="header-anchor" href="#问题-编辑器的-增量提交-到底提交的是什么" aria-label="Permalink to &quot;问题：编辑器的“增量提交”到底提交的是什么？&quot;">​</a></h2><p>先明确一个很现实的问题：你提交的是“文本变化”，还是“文档变化”？</p><ul><li>如果你提交整份 HTML：数据大、不可控、回放难、diff 难</li><li>如果你提交整份 JSON 文档：同样大，且富文本结构变更频繁</li><li>如果你提交操作（ops/steps/patches）：数据小，可回放，但要解决版本对齐、压缩、校验</li></ul><p>所以工程上更常见的落点是：<strong>提交操作日志（op log），配合快照（snapshot）与版本管理（versioning）</strong>。</p><p>这套组合拳解决三个问题：</p><ol><li>网络层：怎么把变更传出去（batch、重试、幂等）</li><li>一致性层：怎么知道谁落后了、缺哪段日志（版本向量/修订号）</li><li>可运维层：怎么排障（确定性回放、对账校验）</li></ol><h2 id="分析-版本管理的三种常见模型-横向对比" tabindex="-1">分析：版本管理的三种常见模型（横向对比） <a class="header-anchor" href="#分析-版本管理的三种常见模型-横向对比" aria-label="Permalink to &quot;分析：版本管理的三种常见模型（横向对比）&quot;">​</a></h2><table tabindex="0"><thead><tr><th>模型</th><th>形态</th><th>解决的问题</th><th>适用场景</th><th>常见坑</th></tr></thead><tbody><tr><td>单调 revision（rev）</td><td>服务端权威递增整数</td><td>顺序、回放、补洞</td><td>OT/中心化协同</td><td>离线合并弱、跨房间/分片需要额外设计</td></tr><tr><td>Lamport clock</td><td>(counter, clientId)</td><td>部分因果顺序</td><td>分布式事件排序</td><td>只能给出“先后”，难表达“并发集合”</td></tr><tr><td>Version vector（向量时钟）</td><td>client -&gt; counter map</td><td>因果关系与缺失集合</td><td>CRDT/离线协同</td><td>向量膨胀，需要压缩与成员管理</td></tr></tbody></table><p>四舍五入：如果你的协同是“服务端权威广播”，rev 是最直接的；如果你需要离线编辑 + 多端合并，向量时钟更靠谱。</p><h2 id="解决方案-op-log-snapshot-校验-纵向深入两层" tabindex="-1">解决方案：op log + snapshot + 校验（纵向深入两层） <a class="header-anchor" href="#解决方案-op-log-snapshot-校验-纵向深入两层" aria-label="Permalink to &quot;解决方案：op log + snapshot + 校验（纵向深入两层）&quot;">​</a></h2><p>我习惯把系统拆两层：</p><ul><li>数据层：操作是事实（op log），快照是锚点（snapshot）</li><li>系统层：网络重试、幂等、对账、回放，让系统可运维</li></ul><h3 id="增量提交架构图-源文件-assets-diagrams-versioning-oplog-snapshot-mmd" tabindex="-1">增量提交架构图（源文件：<code>../assets/diagrams/versioning-oplog-snapshot.mmd</code>） <a class="header-anchor" href="#增量提交架构图-源文件-assets-diagrams-versioning-oplog-snapshot-mmd" aria-label="Permalink to &quot;增量提交架构图（源文件：`../assets/diagrams/versioning-oplog-snapshot.mmd`）&quot;">​</a></h3><!--[--><div class="vp-code-group" data-v-98f790ee><pre data-v-98f790ee><code data-v-98f790ee>flowchart LR
  subgraph Client
    E[Editor]
    B[Batcher&lt;br/&gt;(debounce/merge)]
    L[Local Log]
    E --&gt; B --&gt; L
  end

  subgraph Server
    V[Validator]
    P[Persist Log]
    S[Snapshotter]
    V --&gt; P --&gt; S
  end

  Client --&gt;|push ops + version| V
  Server --&gt;|broadcast ops| Client
  S --&gt;|serve snapshot + tail ops| Client
</code></pre></div><!--teleport start--><!--teleport end--><!--]--><h3 id="版本管理的-几何直觉-rev、opid、向量时钟各解决一类痛点" tabindex="-1">版本管理的“几何直觉”：rev、opId、向量时钟各解决一类痛点 <a class="header-anchor" href="#版本管理的-几何直觉-rev、opid、向量时钟各解决一类痛点" aria-label="Permalink to &quot;版本管理的“几何直觉”：rev、opId、向量时钟各解决一类痛点&quot;">​</a></h3><p>我更喜欢把版本管理类比成 Git（但别过度类比）：</p><ul><li>op log 像 commit 序列：每一条操作是一个可回放的“事实”</li><li>snapshot 像 tag/checkout 点：把历史压平到一个锚点</li><li>校验像 hash：你得能证明“大家看的确实是同一份内容”</li></ul><p>下面用符号把三个常见模型讲清楚。</p><h4 id="_1-单调-revision-最容易落地的中心化版本模型" tabindex="-1">1) 单调 revision：最容易落地的中心化版本模型 <a class="header-anchor" href="#_1-单调-revision-最容易落地的中心化版本模型" aria-label="Permalink to &quot;1) 单调 revision：最容易落地的中心化版本模型&quot;">​</a></h4><p>设服务端维护一个单调递增版本号 revₛ。客户端记录自己已确认的 rev_c。</p><p>当客户端重连时，“缺哪段日志”其实就是一个区间：</p><ul><li>missing = (rev_c, revₛ]</li></ul><p>这句话写出来，很多边界条件就自然出现：</p><ul><li>rev_c 可能大于 revₛ（客户端缓存坏了/跨房间提交）：要拒绝并下发 snapshot</li><li>missing 可能很长：要下发 snapshot + tail ops，而不是全量 oplog</li></ul><h4 id="_2-幂等提交-opid-是网络重试的-身份证" tabindex="-1">2) 幂等提交：opId 是网络重试的“身份证” <a class="header-anchor" href="#_2-幂等提交-opid-是网络重试的-身份证" aria-label="Permalink to &quot;2) 幂等提交：opId 是网络重试的“身份证”&quot;">​</a></h4><p>网络层一定会重试，重试就一定会重复提交。因此你需要让“提交”变成幂等操作。</p><p>最朴素的做法：每个 op 带一个全局唯一 opId（clientId + localCounter 就够用），服务端维护 seen(opId)。</p><p>规则很简单：</p><ul><li>若 opId 已见过：忽略（不改变 rev，不写入 log）</li><li>若 opId 未见过：写入 log，revₛ := revₛ + 1</li></ul><p>它的意义不是“去重很酷”，而是把“网络层的不确定性”隔离在最外层，避免污染协同语义。</p><h4 id="_3-向量时钟-把-并发集合-讲明白" tabindex="-1">3) 向量时钟：把“并发集合”讲明白 <a class="header-anchor" href="#_3-向量时钟-把-并发集合-讲明白" aria-label="Permalink to &quot;3) 向量时钟：把“并发集合”讲明白&quot;">​</a></h4><p>向量时钟可以看成一个映射 VC：client → counter。</p><p>关键操作只有两个：</p><ul><li>自增：VCᵢ[i] := VCᵢ[i] + 1（本客户端产生新操作）</li><li>合并：Merge(VCᵃ, VCᵇ)[k] := max(VCᵃ[k], VCᵇ[k])</li></ul><p>支配关系（dominates）用来判断“我是否已经看到你的一切”：</p><ul><li>VCᵃ ⪰ VCᵇ 当且仅当 ∀k, VCᵃ[k] ≥ VCᵇ[k]</li></ul><p>它解决的是：离线编辑与多端合并时，单调 rev 说不清“谁缺谁哪些操作”，向量时钟能说清。</p><h3 id="快照-tail-ops-把回放从-无限长-变成-有窗口" tabindex="-1">快照 + tail ops：把回放从“无限长”变成“有窗口” <a class="header-anchor" href="#快照-tail-ops-把回放从-无限长-变成-有窗口" aria-label="Permalink to &quot;快照 + tail ops：把回放从“无限长”变成“有窗口”&quot;">​</a></h3><p>快照 snapshot 是一个锚点，至少包含：</p><ul><li>snapshot.rev：这份状态对应的版本号</li><li>snapshot.doc：完整文档状态（或模型状态）</li><li>snapshot.checksum：用于对账的摘要（hash(doc)，算法不重要，稳定与抗碰撞更重要）</li></ul><p>当服务端下发状态时，尽量下发：</p><ul><li>snapshot（锚点）</li><li>tail ops（从 snapshot.rev 之后的一小段增量）</li></ul><p>客户端回放其实就是一个可复述的式子：</p><ul><li>doc₀ = snapshot.doc</li><li>docₙ = Apply(docₙ₋₁, opₙ)</li></ul><p>只要 Apply 是确定的（同输入同输出），回放就能成为排障底牌：你可以在任何机器上重放同一段 tail ops，得到同一个 checksum。</p><h3 id="重连与补洞流程图-把-掉线-当成常态设计" tabindex="-1">重连与补洞流程图：把“掉线”当成常态设计 <a class="header-anchor" href="#重连与补洞流程图-把-掉线-当成常态设计" aria-label="Permalink to &quot;重连与补洞流程图：把“掉线”当成常态设计&quot;">​</a></h3><!--[--><div class="vp-code-group" data-v-98f790ee><pre data-v-98f790ee><code data-v-98f790ee>flowchart TB
  DC[断线/切后台] --&gt; RC[重连]
  RC --&gt; HS[握手: 上报 rev 或 vector clock]
  HS --&gt; DIFF[服务端计算缺失区间/缺失集合]
  DIFF --&gt;|过长/不可信| SNAP[下发 snapshot]
  DIFF --&gt;|可补洞| TAIL[下发 tail ops]
  SNAP --&gt; APPLY[客户端应用 snapshot]
  TAIL --&gt; REPLAY[客户端回放 tail ops]
  APPLY --&gt; REPLAY
  REPLAY --&gt; CK[对账: checksum 比对]
  CK --&gt;|一致| OK[进入实时协同]
  CK --&gt;|不一致| FIX[强制下发 snapshot&lt;br/&gt;或触发回放诊断]
</code></pre></div><!--teleport start--><!--teleport end--><!--]--><h2 id="工程实践-增量提交的-坑点清单" tabindex="-1">工程实践：增量提交的“坑点清单” <a class="header-anchor" href="#工程实践-增量提交的-坑点清单" aria-label="Permalink to &quot;工程实践：增量提交的“坑点清单”&quot;">​</a></h2><h3 id="_1-提交边界-ime、粘贴与批量操作" tabindex="-1">1) 提交边界：IME、粘贴与批量操作 <a class="header-anchor" href="#_1-提交边界-ime、粘贴与批量操作" aria-label="Permalink to &quot;1) 提交边界：IME、粘贴与批量操作&quot;">​</a></h3><ul><li>IME（composition）期间不要拆碎成一堆 op；否则回放会出现“看起来一样但选区乱了”的诡异问题</li><li>粘贴/格式化通常是批量变更：应该合并成一个 transaction/op batch</li><li>大操作需要“分帧提交”：避免主线程一次性处理过多变更导致卡顿</li></ul><h3 id="_2-压缩-compaction-日志一定会膨胀" tabindex="-1">2) 压缩（compaction）：日志一定会膨胀 <a class="header-anchor" href="#_2-压缩-compaction-日志一定会膨胀" aria-label="Permalink to &quot;2) 压缩（compaction）：日志一定会膨胀&quot;">​</a></h3><ul><li>相邻插入可合并（pos 连续、来源同一批次）</li><li>insert + delete 抵消可简化</li><li>到某个阈值做 snapshot，把 tail 控制在可回放窗口</li></ul><h3 id="_3-对账-checksum-不要迷信-最终一致" tabindex="-1">3) 对账（checksum）：不要迷信“最终一致” <a class="header-anchor" href="#_3-对账-checksum-不要迷信-最终一致" aria-label="Permalink to &quot;3) 对账（checksum）：不要迷信“最终一致”&quot;">​</a></h3><p>一致性不是一句口号，它要可证明：</p><ul><li>客户端定期上报 checksum（针对 snapshot rev）</li><li>服务端计算同 rev 的 checksum 做对账</li><li>不一致就触发回放与修复（下发 snapshot）</li></ul><p>这里有一个容易被忽略的工程细节：checksum 不一致时，你不要急着“直接覆盖客户端”。</p><p>更稳的处理流程是：</p><ul><li>先冻结客户端继续提交（否则你会在错误状态上继续累积）</li><li>拉取服务端的 snapshot + tail ops，与本地 oplog 做一次对比回放</li><li>如果能定位到某一段 tail ops 导致分歧：记录并上报（这是排障证据）</li><li>最后再选择修复策略：覆盖、合并、或提示用户冲突（取决于产品规则）</li></ul><p>比喻一下：对账像银行对账单。对不上不是立刻把你的余额改成银行的，而是先找出哪一笔流水不一致，然后再决定怎么处理。</p><h3 id="_4-背压-backpressure-别让网络把编辑器拖死" tabindex="-1">4) 背压（backpressure）：别让网络把编辑器拖死 <a class="header-anchor" href="#_4-背压-backpressure-别让网络把编辑器拖死" aria-label="Permalink to &quot;4) 背压（backpressure）：别让网络把编辑器拖死&quot;">​</a></h3><p>增量提交最容易忽略的一点是：编辑器的输入是连续的，但网络与服务端处理能力是离散的。</p><p>你需要一个“背压策略”，否则会出现两种极端：</p><ul><li>客户端疯狂堆 op：内存增长、重连补洞变成灾难</li><li>客户端强行等确认：输入延迟上升，用户感觉“打字黏”</li></ul><p>工程上更稳的做法是分三层缓冲：</p><ul><li>UI 层：输入即时生效（本地先 apply）</li><li>传输层：op 批量发送（batch）+ 限速（rate limit）+ 合并（merge）</li><li>存储层：服务端确认后再推进“已确认水位线”（confirmed rev / confirmed VC）</li></ul><p>比喻一下：这就像快递揽收。用户把包裹交给你（本地生效），你可以先放到仓库（本地 log），但你不能让仓库无限堆，也不能要求每个包裹都必须当天送达才允许继续揽收。</p><h3 id="_5-快照策略-什么时候打点、打多密" tabindex="-1">5) 快照策略：什么时候打点、打多密？ <a class="header-anchor" href="#_5-快照策略-什么时候打点、打多密" aria-label="Permalink to &quot;5) 快照策略：什么时候打点、打多密？&quot;">​</a></h3><p>快照不是越多越好。快照太密会带来：</p><ul><li>服务端写放大（存储与 IO 压力）</li><li>生成快照的 CPU 成本</li></ul><p>快照太稀会带来：</p><ul><li>重连 tail ops 太长，回放耗时不可控</li><li>线上排障难度上升（缺少稳定锚点）</li></ul><p>比较常见的折中策略是“阈值触发”：</p><ul><li>当 tail ops 数量超过 N，或 tail 字节超过 M，触发一次 snapshot</li><li>或者按时间窗口定期 snapshot（例如每 30s / 2min），配合阈值兜底</li></ul><p>四舍五入：快照是把系统从“可用”推到“可运维”的关键设施，建议在早期就设计好，而不是等日志膨胀后再补。</p><h2 id="关键前提-apply-必须确定-否则一切对账都只是自欺欺人" tabindex="-1">关键前提：Apply 必须确定，否则一切对账都只是自欺欺人 <a class="header-anchor" href="#关键前提-apply-必须确定-否则一切对账都只是自欺欺人" aria-label="Permalink to &quot;关键前提：Apply 必须确定，否则一切对账都只是自欺欺人&quot;">​</a></h2><p>上面很多设计（checksum、回放、tail 窗口）都隐含了一个前提：同一段 snapshot + 同一段 tail ops，在任何机器上回放都必须得到同一份结果。否则你会遇到一种最糟糕的情况：系统能同步，但永远对不上账。</p><p>导致非确定性的常见来源包括：</p><ul><li>依赖当前时间、随机数、或浏览器环境差异（例如不同字体测量导致布局回写到模型）</li><li>插件在 apply 阶段读取外部状态（网络返回、localStorage、全局单例）</li><li>normalize 规则不稳定（同一份输入在不同顺序下修复出不同结果）</li></ul><p>工程上更稳的约束是：模型层的 Apply 与 Normalize 必须是纯函数风格，外部依赖要么被显式写入 op payload，要么只允许在渲染层产生影响（不回写模型）。</p><h2 id="回放诊断-把-偶现-压缩成可复制的最小证据" tabindex="-1">回放诊断：把“偶现”压缩成可复制的最小证据 <a class="header-anchor" href="#回放诊断-把-偶现-压缩成可复制的最小证据" aria-label="Permalink to &quot;回放诊断：把“偶现”压缩成可复制的最小证据&quot;">​</a></h2><p>当对账失败时，真正值钱的不是“重新下发快照把用户救回来”，而是把分歧变成一份可复制的证据。建议你在系统里预留一个最小诊断包：</p><ul><li>snapshot（含 rev 与 checksum）</li><li>tail ops（含每条 op 的 id、来源、时间戳/逻辑时间、摘要）</li><li>关键环境（浏览器版本、输入法状态、核心与插件版本矩阵）</li></ul><p>这份诊断包的目标不是“把所有信息都打出来”，而是让你能在本地一键重放，并稳定复现分歧发生的那一条 op。只要能稳定复现，修复就会从玄学变成工程。</p><h2 id="确认水位线-本地先应用不等于-已经安全" tabindex="-1">确认水位线：本地先应用不等于“已经安全” <a class="header-anchor" href="#确认水位线-本地先应用不等于-已经安全" aria-label="Permalink to &quot;确认水位线：本地先应用不等于“已经安全”&quot;">​</a></h2><p>增量提交系统里有两个很容易混淆的概念：</p><ul><li>本地已应用：用户看到的内容已经更新（体验优先）</li><li>服务端已确认：这段变更已经进入“可回放事实”（安全与一致性）</li></ul><p>如果你不区分这两者，就会遇到一类非常经典的线上事故：用户输入了内容，看起来没问题；但网络抖一下、服务端拒绝一批 ops、或者发生重连补洞后，这段内容悄悄消失或被回滚，用户只会觉得“你吃字了”。</p><p>更稳的做法是维护一个“确认水位线”：</p><ul><li>对中心化 rev：confirmedRev ≤ localRev</li><li>对向量时钟：confirmedVC ⪯ localVC（逐分量不大于）</li></ul><p>并在 UI 层做最小可见化：</p><ul><li>未确认的变更可以有轻量提示（例如状态栏“正在同步…”）</li><li>当出现拒绝/回滚时，要能把差异定位到具体 op（而不是整份文档闪回）</li></ul><p>这背后其实是一条系统设计原则：本地乐观更新可以提升体验，但必须用“确认水位线 + 回放证据”把一致性与安全补回来。</p><h2 id="日志压缩的边界-哪些能合并-哪些不能碰" tabindex="-1">日志压缩的边界：哪些能合并，哪些不能碰 <a class="header-anchor" href="#日志压缩的边界-哪些能合并-哪些不能碰" aria-label="Permalink to &quot;日志压缩的边界：哪些能合并，哪些不能碰&quot;">​</a></h2><p>很多人讲 compaction 时会说“相邻插入合并、insert+delete 抵消”，听起来都对，但真正落地时最容易踩的坑是：你合并了本不该合并的东西，结果回放仍然一致，但用户语义变了（撤销粒度变了、协同里光标跳了、选区映射不再可解释）。</p><p>更稳的原则是先写清楚“合并边界”：</p><ul><li><strong>输入边界</strong>：IME composition 期间的中间态不要跨边界合并到最终上屏之外</li><li><strong>事务边界</strong>：不同 transaction 的 op 不要随意跨事务合并，否则你会把产品语义改坏</li><li><strong>结构边界</strong>：跨节点/跨块的变更不要用纯文本规则粗暴合并，否则 normalize 的结果可能不同</li></ul><p>一种更工程化的做法是给每批 op 打上 batchId，并把 batchId 作为合并条件之一：同一 batchId 的相邻 op 才允许合并。这样你至少能把合并范围限定在“人类一次操作”的窗口里，而不是把整段历史揉成一坨。</p><p>四舍五入：压缩不是为了让日志更漂亮，而是为了把回放窗口控制在可用范围内，同时不破坏你对“用户一次操作”的语义承诺。</p><h2 id="校验的边界-checksum-不是安全机制-但它是工程底线" tabindex="-1">校验的边界：checksum 不是安全机制，但它是工程底线 <a class="header-anchor" href="#校验的边界-checksum-不是安全机制-但它是工程底线" aria-label="Permalink to &quot;校验的边界：checksum 不是安全机制，但它是工程底线&quot;">​</a></h2><p>很多人听到 checksum 会下意识联想到“安全”，但在协同系统里 checksum 的第一目标不是防攻击，而是防分歧：你要快速回答“我们是不是在同一个世界里”。因此你更关心的是稳定性与可重复性，而不是密码学意义上的完美。</p><p>一个更可操作的 checklist 是：</p><ul><li>校验输入必须明确：按同一种序列化方式 hash（不要一边 hash JSON，一边 hash HTML）</li><li>校验粒度必须可控：既要能对 snapshot 整体校验，也要能对某个段落/某个 block 做局部校验</li><li>校验失败必须可止血：允许快速进入“冻结提交 → 下发快照 → 记录诊断包”的模式</li></ul><p>你可以把它写成非常朴素的形式：checksum = H(Serialize(doc, rev))。这里真正重要的不是 H 是什么，而是 Serialize 的确定性：字段顺序、默认值、浮点数格式、以及是否包含临时字段，都必须被明确约束。否则你会遇到一种最让人绝望的情况：数据其实一致，但 checksum 永远对不上。</p><h2 id="参考与引用" tabindex="-1">参考与引用 <a class="header-anchor" href="#参考与引用" aria-label="Permalink to &quot;参考与引用&quot;">​</a></h2><ol><li>ProseMirror collab 示例（op 级同步思路）：<a href="https://prosemirror.net/examples/collab/" target="_blank" rel="noreferrer">https://prosemirror.net/examples/collab/</a> （Bib: <code>prosemirror_collab</code>）</li><li>Yjs 基础与同步协议：<a href="https://docs.yjs.dev/" target="_blank" rel="noreferrer">https://docs.yjs.dev/</a> （Bib: <code>yjs_docs</code>）</li><li>Automerge（CRDT）文档：<a href="https://automerge.org/" target="_blank" rel="noreferrer">https://automerge.org/</a> （Bib: <code>automerge_docs</code>）</li><li>W3C WebSocket API（传输层基建）：<a href="https://websockets.spec.whatwg.org/" target="_blank" rel="noreferrer">https://websockets.spec.whatwg.org/</a> （Bib: <code>whatwg_websocket</code>）</li></ol></div></div></main><footer class="VPDocFooter" data-v-55d9feae data-v-56184811><!--[--><!--]--><div class="edit-info" data-v-56184811><!----><div class="last-updated" data-v-56184811><p class="VPLastUpdated" data-v-56184811 data-v-849a375e>Last updated: <time datetime="2026-01-21T20:13:49.000Z" data-v-849a375e></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-56184811><span class="visually-hidden" id="doc-footer-aria-label" data-v-56184811>Pager</span><div class="pager" data-v-56184811><a class="VPLink link pager-link prev" href="/web-editor/04-doc-storage-and-indexes" data-v-56184811><!--[--><span class="desc" data-v-56184811>Previous page</span><span class="title" data-v-56184811>Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树</span><!--]--></a></div><div class="pager" data-v-56184811><a class="VPLink link pager-link next" href="/web-editor/06-open-source-editors-comparison" data-v-56184811><!--[--><span class="desc" data-v-56184811>Next page</span><span class="title" data-v-56184811>开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"DyVshCfW\",\"about.prev.md\":\"597GxILS\",\"about.reference.md\":\"ByaC_d4S\",\"ai-chitchat_01-ml-dl-basics-for-engineers.md\":\"CUvUVsfQ\",\"ai-chitchat_02-diffusion-models-primer.md\":\"O87dNlNS\",\"ai-chitchat_03-ecommerce-diffusion-practice.md\":\"BNbuvoy7\",\"ai-chitchat_04-llm-primer-for-engineers.md\":\"W5bGBxSz\",\"ai-chitchat_05-ecommerce-llm-agent-practice.md\":\"C1uVTnm-\",\"ai-chitchat_06-ai-positioning-and-engineering-playbook.md\":\"DS31bhos\",\"ai-chitchat_07-vibecoding-three-horses-faster.md\":\"Le0SV0lZ\",\"ai-chitchat___outline.md\":\"D2sMqQ0Y\",\"browser-rendering_01-chromium-architecture-processes-and-threads.md\":\"CmE_DedH\",\"browser-rendering_02-blink-lifecycle-style-layout-paint.md\":\"xA0fFQ-6\",\"browser-rendering_03-cc-compositor-commit-activate-draw.md\":\"7Bmwa6Sw\",\"browser-rendering_04-viz-gpu-and-present-to-screen.md\":\"_CxNCmj-\",\"browser-rendering_05-input-latency-scroll-and-hit-test.md\":\"CyG0Jzn1\",\"browser-rendering_06-v8-for-frontend-hiddenclass-ic-gc.md\":\"DHID4y2I\",\"browser-rendering_07-workers-offscreen-canvas-and-transfer-cost.md\":\"rMMyMmli\",\"browser-rendering_08-performance-tracing-devtools-perfetto.md\":\"Wx8TVTEP\",\"browser-rendering_09-frontend-levers-css-composite-paint-budget.md\":\"BA_AjO5P\",\"browser-rendering___outline.md\":\"DpwKIuN_\",\"data-systems___outline.md\":\"B45QYMT9\",\"ds-algorithms___outline.md\":\"D3Y433Q0\",\"frontend-architecture___outline.md\":\"DxI8aP5l\",\"index.md\":\"BePkVEQb\",\"js-core___outline.md\":\"CB4tIsXw\",\"okr_2021.md\":\"deYcZw_4\",\"okr_2022.md\":\"B_JUpneV\",\"okr_2023.md\":\"oC4DYVGP\",\"okr_2024.md\":\"DMrvr2D7\",\"performance___outline.md\":\"BsJR2FvL\",\"ten-years_2025-aigc-interview-notes.md\":\"Dr__dOoU\",\"ten-years_2025-core-plus-plugins.md\":\"DxZeSV_y\",\"ten-years_2025-release-patterns.md\":\"BgKHcly8\",\"ten-years_2025.md\":\"BtAXpM8J\",\"web-editor_01-editor-architecture.md\":\"vjlrosSW\",\"web-editor_02-collaboration-crdt-ot.md\":\"CUutVa6h\",\"web-editor_03-plugin-system.md\":\"Cukgr8KN\",\"web-editor_04-doc-storage-and-indexes.md\":\"Cwic9sDY\",\"web-editor_05-versioning-and-incremental-sync.md\":\"CCnHZl0T\",\"web-editor_06-open-source-editors-comparison.md\":\"b2eieCYN\",\"web-editor_07-fonts-history-and-secrets.md\":\"BkJdG9J6\",\"web-editor_08-images-history-and-secrets.md\":\"Bir1KWCa\",\"web-editor_09-layout-algorithms-constraint.md\":\"CiKt2lJB\",\"web-editor_10-unicode-linebreak-bidi-grapheme.md\":\"GNOYqyKz\",\"web-editor_11-hit-testing-and-event-system.md\":\"DZX37h-j\",\"web-editor_12-rendering-graphics-details.md\":\"BWKLyOWF\",\"web-editor___outline.md\":\"CjNuMFXE\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"2026\",\"description\":\"Book preview from source/_posts/2026\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"sidebar\":[{\"text\":\"目录\",\"collapsed\":false,\"items\":[{\"text\":\"引序\",\"link\":\"/\"},{\"text\":\"Web 编辑器与协同\",\"collapsed\":true,\"items\":[{\"text\":\"Web 编辑器：核心架构与“轮点”演进\",\"link\":\"/web-editor/01-editor-architecture\"},{\"text\":\"协同编辑：CRDT vs OT 的工程取舍（以及富文本的坑）\",\"link\":\"/web-editor/02-collaboration-crdt-ot\"},{\"text\":\"Web 编辑器插件体系：可扩展、可治理、可兜底\",\"link\":\"/web-editor/03-plugin-system\"},{\"text\":\"Web 编辑器的数据怎么存：Rope、Piece Table、区间树与红黑树\",\"link\":\"/web-editor/04-doc-storage-and-indexes\"},{\"text\":\"Web 编辑器如何增量提交与版本管理：op log、快照与可回放系统\",\"link\":\"/web-editor/05-versioning-and-incremental-sync\"},{\"text\":\"开源 Web 富文本横向对比：tiptap / ProseMirror / Slate / Lexical / Quill\",\"link\":\"/web-editor/06-open-source-editors-comparison\"},{\"text\":\"字体发展史与字体的秘密：从 OpenType 到编辑器排版管线\",\"link\":\"/web-editor/07-fonts-history-and-secrets\"},{\"text\":\"图片发展史与图片的秘密：格式、解码、色彩空间与编辑器性能\",\"link\":\"/web-editor/08-images-history-and-secrets\"},{\"text\":\"约束布局与排版算法：编辑器如何把“文档”排成“可交互的版面”\",\"link\":\"/web-editor/09-layout-algorithms-constraint\"},{\"text\":\"Unicode 行内排版三件套：Line Break / Bidi / Grapheme Break\",\"link\":\"/web-editor/10-unicode-linebreak-bidi-grapheme\"},{\"text\":\"点击测试（Hit Testing）与事件系统：从坐标到交互闭环\",\"link\":\"/web-editor/11-hit-testing-and-event-system\"},{\"text\":\"渲染图形学细节：矩阵、Shader、CPU/GPU 与瓦片化（Tiling）\",\"link\":\"/web-editor/12-rendering-graphics-details\"}]},{\"text\":\"浏览器底层与图形渲染\",\"collapsed\":true,\"items\":[{\"text\":\"Chromium 架构总览：多进程与线程模型\",\"link\":\"/browser-rendering/01-chromium-architecture-processes-and-threads\"},{\"text\":\"Blink 生命周期：style/layout/paint 与无效化\",\"link\":\"/browser-rendering/02-blink-lifecycle-style-layout-paint\"},{\"text\":\"cc 合成体系：两棵树、属性树与同步点\",\"link\":\"/browser-rendering/03-cc-compositor-commit-activate-draw\"},{\"text\":\"Viz/GPU/上屏：surface、buffer 与显示路径\",\"link\":\"/browser-rendering/04-viz-gpu-and-present-to-screen\"},{\"text\":\"输入与滚动：事件路由、命中与延迟下限\",\"link\":\"/browser-rendering/05-input-latency-scroll-and-hit-test\"},{\"text\":\"V8 细节（前端视角）：优化、deopt 与 GC\",\"link\":\"/browser-rendering/06-v8-for-frontend-hiddenclass-ic-gc\"},{\"text\":\"Worker：收益边界、OffscreenCanvas 与通信成本\",\"link\":\"/browser-rendering/07-workers-offscreen-canvas-and-transfer-cost\"},{\"text\":\"可观测：DevTools、Tracing/Perfetto 与归因方法\",\"link\":\"/browser-rendering/08-performance-tracing-devtools-perfetto\"},{\"text\":\"前端对照表：哪些写法对应哪条渲染管线\",\"link\":\"/browser-rendering/09-frontend-levers-css-composite-paint-budget\"}]},{\"text\":\"AI 碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"AI 碎碎念 01：机器学习与深度学习的浅尝即止（工程师够用版）\",\"link\":\"/ai-chitchat/01-ml-dl-basics-for-engineers\"},{\"text\":\"AI 碎碎念 02：扩散模型从 DDPM 到 DiT（用类比讲清楚加噪与去噪）\",\"link\":\"/ai-chitchat/02-diffusion-models-primer\"},{\"text\":\"AI 碎碎念 03：电商里的扩散模型折腾记（Mask、Inpaint、Outpaint 到虚拟试衣）\",\"link\":\"/ai-chitchat/03-ecommerce-diffusion-practice\"},{\"text\":\"AI 碎碎念 04：LLM 够用版原理（Transformer、上下文与概率）\",\"link\":\"/ai-chitchat/04-llm-primer-for-engineers\"},{\"text\":\"AI 碎碎念 05：电商里的 LLM 落地（Agent、Prompt 与 A2UI）\",\"link\":\"/ai-chitchat/05-ecommerce-llm-agent-practice\"},{\"text\":\"AI 碎碎念 06：我的定位与工程人的做法（不神化，不自卑）\",\"link\":\"/ai-chitchat/06-ai-positioning-and-engineering-playbook\"},{\"text\":\"AI 碎碎念 07：从 Vibe Coding 到 Spec-Driven Dev：四个轮子复刻 Faster\",\"link\":\"/ai-chitchat/07-vibecoding-three-horses-faster\"}]},{\"text\":\"工作的碎碎念\",\"collapsed\":true,\"items\":[{\"text\":\"2024-2025：字节电商 AIGC（面试速记版）\",\"link\":\"/ten-years/2025-aigc-interview-notes\"},{\"text\":\"为什么重交互产品都长成 Core + Plugins\",\"link\":\"/ten-years/2025-core-plus-plugins\"},{\"text\":\"四种发版节奏对比\",\"link\":\"/ten-years/2025-release-patterns\"},{\"text\":\"2025：十年再回首我的工作经历\",\"link\":\"/ten-years/2025\"}]}]}],\"outline\":\"deep\",\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>